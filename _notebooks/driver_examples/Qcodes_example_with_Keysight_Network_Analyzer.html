

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example Notebook for Keysight Network Analyzers &mdash; QCoDeS 0.1.11 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Agilent 34411A versus Keysight 34465A" href="../benchmarking/Agilent 34411A versus Keysight 34465A.html" />
    <link rel="prev" title="Example Notebook for Keysight Infiniium Oscilloscopes" href="Qcodes_example_with_Keysight_Infiniium_Oscilloscope.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> QCoDeS
          

          
          </a>

          
            
            
              <div class="version">
                0.1.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">Get Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataset/index.html">DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Classes and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/generated/qcodes.instrument_drivers.html">qcodes.instrument_drivers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Qcodes project plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes/index.html">Changelogs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples/index.html">Examples of using QCoDeS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#basic-examples">Basic examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#dataset">DataSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#plotting">Plotting</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../examples/index.html#drivers">Drivers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="QCodes example Rigol DG1062.html">Example notebook for the Rigol DG 1062 instrument</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCodes example with SR830.html">QCoDeS example with SR830</a></li>
<li class="toctree-l3"><a class="reference internal" href="QCodes_example_with_SR86x_with_buffered_readout.html">Standford Research SR86x Lock-in Amplifier example (with buffered readout)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Agilent 34400A.html">Qcodes example with Agilent 34400A</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Alazar 9360.html">Qcodes example with Alazar ATS 9360</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Ithaco.html">Qcodes example with Ithaco</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Keithley 2600.html">Qcodes example with Keithley 2600</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Keysight 33500B.html">Qcodes example with Keysight 33500B</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Lakeshore 325.html">Lakeshore 325 driver example</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Lakeshore 325.html#go-to-a-set-point">Go to a set point</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Lakeshore 336 or 372 - Bluefors T control.html">Example usage of the Lakeshore Model 372 to control the temperature of the Bluefors fridge</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Mercury iPS.html">QCodes example with Mercury iPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Minicircuits Switch boxes (USB-XSPDT).html">Example for Minicircuits Switch Boxes controlled via USB</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Newport AG-UC8.html">Qcodes example with Newport AG-UC8 piezo motion controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with QDac.html">Qcodes example with QDac</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with QDac_channels.html">Qcodes example with QDac_channels</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with R&amp;S HMC8043.html">Qcodes example with R&amp;S HMC 8043 Power supply</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Rigol DP832.html">Qcodes example with Rigol DP832 Power supply</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Rohde Schwarz RTO 1000 series Oscilloscope.html">Qcodes example with Rohde Schwarz RTO 1000 series Oscilloscope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Rohde Schwarz ZNB.html">Qcodes example with Rohde Schwarz ZN20/8</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Signal Hound USB-SA124B.html">Frequency trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Signal Hound USB-SA124B.html#averaging">Averaging</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Signal Hound USB-SA124B.html#power">Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with TPS2012.html">QCoDeS Example with Tektronix TPS2012</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Tektronix AWG5014C.html">QCoDeS Example with Tektronix AWG5014</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Tektronix AWG70002A.html">QCoDeS Example with Tektronix AWG70002A</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Triton.html">Qcodes example with Triton</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Yokogawa GS2xx.html">Qcodes example with Yokogawa GS200/GS210</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with ZI UHF-LI.html">QCoDeS Example with ZI UHF-LI</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes+broadbean_example_with_Tektronix_AWG5208.html">Qcodes+broadbean example with Tektronix AWG5208</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes+broadbean_example_with_Tektronix_AWG5208.html#part-3-play-it-and-capture-it-on-a-scope">Part 3: Play it and capture it on a scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes_example_with_AMI430.html">QCoDeS example with AMI430</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes_example_with_HP8753D.html">Qcodes example with HP8753D</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes_example_with_Keysight_Infiniium_Oscilloscope.html">Example Notebook for Keysight Infiniium Oscilloscopes</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Example Notebook for Keysight Network Analyzers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#connect-to-the-instrument">Connect to the instrument</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simple-measurements">Simple Measurements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reading-multiple-parameters-in-one-measurement">Reading multiple parameters in one measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiple-traces">Multiple Traces</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#benchmarking">Benchmarking</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QCoDeS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../examples/index.html">Examples of using QCoDeS</a> &raquo;</li>
        
      <li>Example Notebook for Keysight Network Analyzers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/_notebooks/driver_examples/Qcodes_example_with_Keysight_Network_Analyzer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="example-notebook-for-keysight-network-analyzers">
<h1>Example Notebook for Keysight Network Analyzers<a class="headerlink" href="#example-notebook-for-keysight-network-analyzers" title="Permalink to this headline">¶</a></h1>
<p>This notebook is indendet to give an overview over the functions
implemented in the QCoDeS driver for the Keysight network analyzers. The
driver is implemented to be generic as possible, with individual
instrument drivers filling in only the hardware limits of the
instrument, so although this example uses the N5245A, the concepts and
code should work for any keysight network analyzer.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import Dependencies</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># qcodes imports</span>
<span class="kn">import</span> <span class="nn">qcodes</span> <span class="k">as</span> <span class="nn">qc</span>
<span class="kn">from</span> <span class="nn">qcodes.dataset.experiment_container</span> <span class="k">import</span> <span class="n">new_experiment</span><span class="p">,</span> <span class="n">load_experiment_by_name</span>
<span class="kn">from</span> <span class="nn">qcodes.dataset.measurements</span> <span class="k">import</span> <span class="n">Measurement</span>
<span class="kn">from</span> <span class="nn">qcodes.dataset.plotting</span> <span class="k">import</span> <span class="n">plot_by_id</span>
<span class="kn">import</span> <span class="nn">qcodes.instrument_drivers.Keysight.N5245A</span> <span class="k">as</span> <span class="nn">N5245A</span>

<span class="c1">#setup</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="c1"># Start experiment</span>
<span class="n">exp_name</span> <span class="o">=</span> <span class="s1">&#39;PNA_Example&#39;</span>
<span class="n">sample_name</span> <span class="o">=</span> <span class="s1">&#39;Thru_Coax&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="n">load_experiment_by_name</span><span class="p">(</span><span class="n">exp_name</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="n">sample_name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Experiment loaded. Last ID no:&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">.</span><span class="n">last_counter</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="n">new_experiment</span><span class="p">(</span><span class="n">exp_name</span><span class="p">,</span> <span class="n">sample_name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting new experiment.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Experiment</span> <span class="n">loaded</span><span class="o">.</span> <span class="n">Last</span> <span class="n">ID</span> <span class="n">no</span><span class="p">:</span> <span class="mi">16</span>
</pre></div>
</div>
<div class="section" id="connect-to-the-instrument">
<h2>Connect to the instrument<a class="headerlink" href="#connect-to-the-instrument" title="Permalink to this headline">¶</a></h2>
<p>You will have to insert the correct VISA address for your PNA below. On
my PC, the PNA has IP address <code class="docutils literal notranslate"><span class="pre">192.168.0.10</span></code>. You can generally use NI
MAX or Agilent IO Toolkit to figure out what the VISA address of your
instrument is, particularly for USB or GPIB connections.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pna</span> <span class="o">=</span> <span class="n">N5245A</span><span class="o">.</span><span class="n">N5245A</span><span class="p">(</span><span class="s1">&#39;pna&#39;</span><span class="p">,</span> <span class="s1">&#39;TCPIP::192.168.0.10::inst0::INSTR&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Connected</span> <span class="n">to</span><span class="p">:</span> <span class="n">Agilent</span> <span class="n">Technologies</span> <span class="n">N5245A</span> <span class="p">(</span><span class="n">serial</span><span class="p">:</span><span class="n">MY52451750</span><span class="p">,</span> <span class="n">firmware</span><span class="p">:</span><span class="n">A</span><span class="o">.</span><span class="mf">10.49</span><span class="o">.</span><span class="mi">08</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.21</span><span class="n">s</span>
</pre></div>
</div>
</div>
<div class="section" id="simple-measurements">
<h2>Simple Measurements<a class="headerlink" href="#simple-measurements" title="Permalink to this headline">¶</a></h2>
<p>We can very easily set up measurements and pull, for example, magnitude
data off the PNA.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a frequency sweep from 100 MHz to 1 GHz, with 1001 points, at a power of -40dBm</span>
<span class="n">pna</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">)</span>
<span class="n">pna</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mf">100e6</span><span class="p">)</span>
<span class="n">pna</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span>
<span class="n">pna</span><span class="o">.</span><span class="n">points</span><span class="p">(</span><span class="mi">1001</span><span class="p">)</span>
<span class="n">pna</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s2">&quot;S21&quot;</span><span class="p">)</span>

<span class="c1"># Enable 2 averages, and set IF BW to 1kHz</span>
<span class="n">pna</span><span class="o">.</span><span class="n">if_bandwidth</span><span class="p">(</span><span class="mf">1e3</span><span class="p">)</span>
<span class="n">pna</span><span class="o">.</span><span class="n">averages_enabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pna</span><span class="o">.</span><span class="n">averages</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Run a measurement</span>
<span class="n">meas</span> <span class="o">=</span> <span class="n">Measurement</span><span class="p">()</span>
<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">pna</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>

<span class="k">with</span> <span class="n">meas</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="k">as</span> <span class="n">datasaver</span><span class="p">:</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">pna</span><span class="o">.</span><span class="n">magnitude</span><span class="p">()</span>
    <span class="n">datasaver</span><span class="o">.</span><span class="n">add_result</span><span class="p">((</span><span class="n">pna</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">mag</span><span class="p">))</span>
    <span class="n">dataid</span> <span class="o">=</span> <span class="n">datasaver</span><span class="o">.</span><span class="n">run_id</span>
<span class="n">plot_by_id</span><span class="p">(</span><span class="n">dataid</span><span class="p">)</span>

<span class="c1"># Other valid parameter types are:</span>
<span class="c1"># pna.linear_magnitude()</span>
<span class="c1"># pna.phase()</span>
<span class="c1"># pna.unwrapped_phase()</span>
<span class="c1"># pna.group_delay()</span>
<span class="c1"># pna.real()</span>
<span class="c1"># pna.imaginary()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Starting</span> <span class="n">experimental</span> <span class="n">run</span> <span class="k">with</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">17</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([</span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1ba0bf174a8</span><span class="o">&gt;</span><span class="p">],</span> <span class="p">[</span><span class="kc">None</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_6_2.png" src="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_6_2.png" />
</div>
<div class="section" id="reading-multiple-parameters-in-one-measurement">
<h2>Reading multiple parameters in one measurement<a class="headerlink" href="#reading-multiple-parameters-in-one-measurement" title="Permalink to this headline">¶</a></h2>
<p>If we want to read out multiple parameters in a single loop, we can
disable auto-sweep and manually tell the PNA to take new data for each
setpoint. Otherwise, each time we get a measured parameter of the PNA
(e.g. magnitude and phase) a new trace will be taken.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Disable automatic sweeping</span>
<span class="n">pna</span><span class="o">.</span><span class="n">auto_sweep</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Run a measurement</span>
<span class="n">meas</span> <span class="o">=</span> <span class="n">Measurement</span><span class="p">()</span>
<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">pna</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>
<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">pna</span><span class="o">.</span><span class="n">phase</span><span class="p">)</span>

<span class="k">with</span> <span class="n">meas</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="k">as</span> <span class="n">datasaver</span><span class="p">:</span>
    <span class="n">pna</span><span class="o">.</span><span class="n">traces</span><span class="o">.</span><span class="n">tr1</span><span class="o">.</span><span class="n">run_sweep</span><span class="p">()</span> <span class="c1"># Ask the PNA to take a measurement</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">pna</span><span class="o">.</span><span class="n">magnitude</span><span class="p">()</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">pna</span><span class="o">.</span><span class="n">unwrapped_phase</span><span class="p">()</span>
    <span class="n">datasaver</span><span class="o">.</span><span class="n">add_result</span><span class="p">((</span><span class="n">pna</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">mag</span><span class="p">),</span>
                         <span class="p">(</span><span class="n">pna</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span> <span class="n">phase</span><span class="p">))</span>
    <span class="n">dataid</span> <span class="o">=</span> <span class="n">datasaver</span><span class="o">.</span><span class="n">run_id</span>
<span class="n">plot_by_id</span><span class="p">(</span><span class="n">dataid</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Starting</span> <span class="n">experimental</span> <span class="n">run</span> <span class="k">with</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">18</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([</span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1ba0d6cab00</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1ba0e6fe668</span><span class="o">&gt;</span><span class="p">],</span>
 <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_8_2.png" src="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_8_2.png" />
<img alt="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_8_3.png" src="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_8_3.png" />
</div>
<div class="section" id="multiple-traces">
<h2>Multiple Traces<a class="headerlink" href="#multiple-traces" title="Permalink to this headline">¶</a></h2>
<p>We can also read multiple traces off the PNA at once. For example if the
PNA is set up such that: - Trace 1 is S11 - Trace 2 is S12 - Trace 3 is
S21 - Trace 4 is S22</p>
<p>we can read these off simultaneously as follows:</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Disable automatic sweeping</span>
<span class="n">pna</span><span class="o">.</span><span class="n">auto_sweep</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Update the list of traces</span>
<span class="n">traces</span> <span class="o">=</span> <span class="n">pna</span><span class="o">.</span><span class="n">traces</span>

<span class="c1"># Run a measurement</span>
<span class="n">meas</span> <span class="o">=</span> <span class="n">Measurement</span><span class="p">()</span>
<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">traces</span><span class="o">.</span><span class="n">tr1</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>
<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">traces</span><span class="o">.</span><span class="n">tr2</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>
<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">traces</span><span class="o">.</span><span class="n">tr3</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>
<span class="n">meas</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">traces</span><span class="o">.</span><span class="n">tr4</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>

<span class="k">with</span> <span class="n">meas</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="k">as</span> <span class="n">datasaver</span><span class="p">:</span>
    <span class="n">traces</span><span class="o">.</span><span class="n">tr1</span><span class="o">.</span><span class="n">run_sweep</span><span class="p">()</span> <span class="c1"># Ask the PNA to take a measurement</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">traces</span><span class="p">:</span>
        <span class="n">mag</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">magnitude</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">trace</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">mag</span><span class="p">))</span>
    <span class="n">datasaver</span><span class="o">.</span><span class="n">add_result</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
    <span class="n">dataid</span> <span class="o">=</span> <span class="n">datasaver</span><span class="o">.</span><span class="n">run_id</span>
<span class="n">plot_by_id</span><span class="p">(</span><span class="n">dataid</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Starting</span> <span class="n">experimental</span> <span class="n">run</span> <span class="k">with</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">20</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([</span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1ba0d6aca58</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1ba0e9b90f0</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1ba0e976a90</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x1ba0e8b3470</span><span class="o">&gt;</span><span class="p">],</span>
 <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_10_2.png" src="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_10_2.png" />
<img alt="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_10_3.png" src="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_10_3.png" />
<img alt="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_10_4.png" src="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_10_4.png" />
<img alt="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_10_5.png" src="../../_images/Qcodes_example_with_Keysight_Network_Analyzer_10_5.png" />
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the PNA back into continuous sweep mode</span>
<span class="n">pna</span><span class="o">.</span><span class="n">sweep_mode</span><span class="p">(</span><span class="s2">&quot;CONT&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../benchmarking/Agilent 34411A versus Keysight 34465A.html" class="btn btn-neutral float-right" title="Agilent 34411A versus Keysight 34465A" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Qcodes_example_with_Keysight_Infiniium_Oscilloscope.html" class="btn btn-neutral" title="Example Notebook for Keysight Infiniium Oscilloscopes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'0.1.11',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>