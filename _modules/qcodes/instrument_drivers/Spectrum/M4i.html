

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>qcodes.instrument_drivers.Spectrum.M4i &mdash; QCoDeS 0.1.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../search.html"/>
    <link rel="top" title="QCoDeS 0.1.2 documentation" href="../../../../index.html"/>
        <link rel="up" title="Module code" href="../../../index.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> QCoDeS
          

          
          </a>

          
            
            
              <div class="version">
                0.1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../help.html">Get Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/index.html">Classes and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/generated/qcodes.instrument_drivers.html">qcodes.instrument_drivers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../roadmap.html">Qcodes project plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../changes/index.html">Changelogs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../index.html">QCoDeS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
      
    <li>qcodes.instrument_drivers.Spectrum.M4i</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for qcodes.instrument_drivers.Spectrum.M4i</h1><div class="highlight"><pre>
<span></span><span class="c1"># **************************************************************************</span>
<span class="c1">#</span>
<span class="c1"># Driver file for M4i.44x-x8</span>
<span class="c1">#</span>
<span class="c1"># **************************************************************************</span>
<span class="c1">#</span>
<span class="c1"># QuTech</span>
<span class="c1">#</span>
<span class="c1"># Written by: Luka Bavdaz, Marco Tagliaferri, Pieter Eendebak</span>
<span class="c1"># Also see: http://spectrum-instrumentation.com/en/m4i-platform-overview</span>
<span class="c1">#</span>

<span class="c1">#%%</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">ctypes</span> <span class="k">as</span> <span class="nn">ct</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">qcodes.utils.validators</span> <span class="k">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">Numbers</span><span class="p">,</span> <span class="n">Anything</span>
<span class="kn">from</span> <span class="nn">qcodes.instrument.base</span> <span class="k">import</span> <span class="n">Instrument</span>
<span class="kn">from</span> <span class="nn">qcodes.instrument.parameter</span> <span class="k">import</span> <span class="n">ManualParameter</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pyspcm</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">&#39;to use the M4i driver install the pyspcm module&#39;</span><span class="p">)</span>

<span class="c1">#%% Helper functions</span>


<div class="viewcode-block" id="szTypeToName"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.szTypeToName">[docs]</a><span class="k">def</span> <span class="nf">szTypeToName</span><span class="p">(</span><span class="n">lCardType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Convert card type to string</span>

<span class="sd">    This function is taken from an example provided by Spectrum GmbH</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sName</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">lVersion</span> <span class="o">=</span> <span class="p">(</span><span class="n">lCardType</span> <span class="o">&amp;</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_VERSIONMASK</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lCardType</span> <span class="o">&amp;</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_SERIESMASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_M2ISERIES</span><span class="p">:</span>
        <span class="n">sName</span> <span class="o">=</span> <span class="s1">&#39;M2i.</span><span class="si">%04x</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">lVersion</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">lCardType</span> <span class="o">&amp;</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_SERIESMASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_M2IEXPSERIES</span><span class="p">:</span>
        <span class="n">sName</span> <span class="o">=</span> <span class="s1">&#39;M2i.</span><span class="si">%04x</span><span class="s1">-Exp&#39;</span> <span class="o">%</span> <span class="n">lVersion</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">lCardType</span> <span class="o">&amp;</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_SERIESMASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_M3ISERIES</span><span class="p">:</span>
        <span class="n">sName</span> <span class="o">=</span> <span class="s1">&#39;M3i.</span><span class="si">%04x</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">lVersion</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">lCardType</span> <span class="o">&amp;</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_SERIESMASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_M3IEXPSERIES</span><span class="p">:</span>
        <span class="n">sName</span> <span class="o">=</span> <span class="s1">&#39;M3i.</span><span class="si">%04x</span><span class="s1">-Exp&#39;</span> <span class="o">%</span> <span class="n">lVersion</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">lCardType</span> <span class="o">&amp;</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_SERIESMASK</span><span class="p">)</span> <span class="o">==</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">TYP_M4IEXPSERIES</span><span class="p">:</span>
        <span class="n">sName</span> <span class="o">=</span> <span class="s1">&#39;M4i.</span><span class="si">%04x</span><span class="s1">-x8&#39;</span> <span class="o">%</span> <span class="n">lVersion</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sName</span> <span class="o">=</span> <span class="s1">&#39;unknown type&#39;</span>
    <span class="k">return</span> <span class="n">sName</span></div>

<span class="c1">#%% Main driver class</span>


<div class="viewcode-block" id="M4i"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i">[docs]</a><span class="k">class</span> <span class="nc">M4i</span><span class="p">(</span><span class="n">Instrument</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cardid</span><span class="o">=</span><span class="s1">&#39;spcm0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Driver for the Spectrum M4i.44xx-x8 cards.</span>

<span class="sd">        For more information see: http://spectrum-instrumentation.com/en/m4i-platform-overview</span>

<span class="sd">        Example:</span>

<span class="sd">            Example usage for acquisition with channel 2 using an external trigger</span>
<span class="sd">            that triggers multiple times with trigger mode HIGH::</span>

<span class="sd">                m4 = M4i(name=&#39;M4i&#39;, server_name=None)</span>
<span class="sd">                m4.enable_channels(pyspcm.CHANNEL2)</span>
<span class="sd">                m4.set_channel_settings(2,mV_range, input_path, termination, coupling, compensation)</span>
<span class="sd">                m4.set_ext0_OR_trigger_settings(pyspcm.SPC_TM_HIGH,termination,coupling,level0)</span>
<span class="sd">                calc = m4.multiple_trigger_acquisition(mV_range,memsize,seg_size,posttrigger_size)</span>

<span class="sd">        Todo:</span>
<span class="sd">          Whenever an error occurs (including validation errors) the python</span>
<span class="sd">          console needs to be restarted</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hCard</span> <span class="o">=</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_hOpen</span><span class="p">(</span><span class="n">cardid</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hCard</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;M4i: no card found</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># add parameters for getting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;card_id&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;card id&#39;</span><span class="p">,</span>
                           <span class="n">parameter_class</span><span class="o">=</span><span class="n">ManualParameter</span><span class="p">,</span>
                           <span class="n">initial_value</span><span class="o">=</span><span class="n">cardid</span><span class="p">,</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Anything</span><span class="p">(),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;The card ID&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;max_sample_rate&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;max sample rate&#39;</span><span class="p">,</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;Hz&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_max_sample_rate</span><span class="p">,</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;The maximumum sample rate&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;memory&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;memory&#39;</span><span class="p">,</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;bytes&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_card_memory</span><span class="p">,</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Amount of memory on card&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;resolution&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;resolution&#39;</span><span class="p">,</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;bits&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_MIINST_BITSPERSAMPLE</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Resolution of the card&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;pcidate&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pcidate&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_PCIDATE</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;The PCI date&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;serial_number&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;serial number&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_PCISERIALNO</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;The serial number of the board&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;channel_count&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;channel count&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CHCOUNT</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Return number of enabled channels&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;input_path_count&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;input path count&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_READAIPATHCOUNT</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Return number of analog input paths&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;input_ranges_count&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;input ranges count&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_READIRCOUNT</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Return number of input ranges for the current input path&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;input_path_features&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;input path features&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_READAIFEATURES</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Return a bitmap of features for current input path&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;available_card_modes&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;available card modes&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_AVAILCARDMODES</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Return a bitmap of available card modes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;card_status&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;card status&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_M2STATUS</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Return a bitmap for the status information&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;read_range_min_0&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;read range min 0&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;mV&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_READRANGEMIN0</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Return the lower border of input range 0&#39;</span><span class="p">)</span>

        <span class="c1"># buffer handling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;user_available_length&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;user available length&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_DATA_AVAIL_USER_LEN</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns the number of currently to the user available bytes inside a sample data transfer&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;user_available_position&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;user available position&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_DATA_AVAIL_USER_POS</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns the position as byte index where the currently available data samles start&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;buffer_fill_size&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;buffer fill size&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_FILLSIZEPROMILLE</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns the current fill size of the on-board memory (FIFO buffer) in promille (1/1000)&#39;</span><span class="p">)</span>

        <span class="c1"># triggering</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;available_trigger_or_mask&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;available trigger or mask&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_AVAILORMASK</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;bitmask, in which all bits of sources for the OR mask are set, if available&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;available_channel_or_mask&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;available channel or mask&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_CH_AVAILORMASK0</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;bitmask, in which all bits of sources/channels (0-31) for the OR mask are set, if available&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;available_trigger_and_mask&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;available trigger and mask&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_AVAILANDMASK</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;bitmask, in which all bits of sources for the AND mask are set, if available&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;available_channel_and_mask&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;available channel and mask&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_CH_AVAILANDMASK0</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;bitmask, in which all bits of sources/channels (0-31) for the AND mask are set, if available&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;available_trigger_delay&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;available trigger delay&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_AVAILDELAY</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;contains the maximum available delay as decimal integer value&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;available_external_trigger_modes&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;available external trigger modes&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_EXT0_AVAILMODES</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;bitmask showing all available trigger modes for external 0 (main analog trigger input)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;external_trigger_min_level&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;external trigger min level&#39;</span><span class="p">,</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;mV&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_EXT_AVAIL0_MIN</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns the minimum trigger level&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;external_trigger_max_level&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;external trigger max level&#39;</span><span class="p">,</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;mV&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_EXT_AVAIL0_MAX</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns the maximum trigger level&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;external_trigger_level_step_size&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;external trigger level step size&#39;</span><span class="p">,</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;mV&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_EXT_AVAIL0_STEP</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns the step size of the trigger level&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;available_channel_trigger_modes&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;available channel trigger modes&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_CH_AVAILMODES</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;bitmask, in which all bits of the modes for the channel trigger are set&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;trigger_counter&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;trigger counter&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIGGERCOUNTER</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns the number of triger events since acquisition start&#39;</span><span class="p">)</span>
        <span class="c1"># data per sample</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;bytes_per_sample&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;bytes per sample&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_MIINST_BYTESPERSAMPLE</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns the number of bytes per sample&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;bits_per_sample&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;bits per sample&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_MIINST_BITSPERSAMPLE</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns the number of bits per sample&#39;</span><span class="p">)</span>

        <span class="c1"># available clock modes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;available_clock_modes&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;available clock modes&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_AVAILCLOCKMODES</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;returns a bitmask in which the bits of the clock modes are set, if available&#39;</span><span class="p">)</span>

        <span class="c1"># converting ADC samples to voltage values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;ADC_to_voltage&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ADC to voltage&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_MIINST_MAXADCVALUE</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;contains the decimal code (in LSB) of the ADC full scale value&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;oversampling_factor&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;oversampling factor&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_OVERSAMPLINGFACTOR</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Reads the oversampling factor&#39;</span><span class="p">)</span>

        <span class="c1"># add parameters for setting and getting (read/write direction</span>
        <span class="c1"># registers)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;enable_channels&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Channels enabled&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CHENABLE</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CHENABLE</span><span class="p">),</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Set and get enabled channels&#39;</span><span class="p">)</span>

        <span class="c1"># analog input path functions</span>
        <span class="c1"># TODO: change Enum validator to set_parser for the numbered functions</span>
        <span class="c1"># if we want string inputs</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;read_input_path&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;read input path&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_READAIPATH</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_READAIPATH</span><span class="p">),</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Select the input path which is used to read out the features&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;input_path_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;input path </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_PATH</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_PATH</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                               <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Set and get analog input path for channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

            <span class="c1"># channel range functions</span>
            <span class="c1"># TODO: check the input path to set the right validator (either by</span>
            <span class="c1"># directly calling input_path_x() or by storing a variable)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;range_channel_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;range channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_AMP</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_AMP</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span>
                                         <span class="mi">2500</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
                               <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Set and get input range of channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

            <span class="c1"># input termination functions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;termination_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;termination </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_50OHM</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_50OHM</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                               <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;if 1 sets termination to 50 Ohm, otherwise 1 MOhm for channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

            <span class="c1"># input coupling</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;ACDC_coupling_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACDC coupling </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_ACDC</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_ACDC</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                               <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;if 1 sets the AC coupling, otherwise sets the DC coupling for channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

            <span class="c1"># AC/DC offset compensation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;ACDC_offs_compensation_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ACDC offs compensation </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_compensation</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                               <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_compensation</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span>
                               <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                               <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;if 1 enables compensation, if 0 disables compensation for channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

            <span class="c1"># anti aliasing filter (Bandwidth limit)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;anti_aliasing_filter_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;anti aliasing filter </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_FILTER</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_FILTER</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                               <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;if 1 selects bandwidth limit, if 0 sets to full bandwidth for channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="c1"># acquisition modes</span>
        <span class="c1"># TODO: If required, the other acquisition modes can be added to the</span>
        <span class="c1"># validator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;card_mode&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;card mode&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CARDMODE</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CARDMODE</span><span class="p">),</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_STD_SINGLE</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_STD_MULTI</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_STD_GATE</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_STD_ABA</span><span class="p">,</span>
                                     <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_FIFO_SINGLE</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_FIFO_MULTI</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_FIFO_GATE</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_FIFO_ABA</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;defines the used operating mode&#39;</span><span class="p">)</span>

        <span class="c1"># wait command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;timeout&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;timeout&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TIMEOUT</span><span class="p">),</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TIMEOUT</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;defines the timeout for wait commands&#39;</span><span class="p">)</span>

        <span class="c1"># Single acquisition mode memory, pre- and posttrigger (pretrigger = memory size - posttrigger)</span>
        <span class="c1"># TODO: improve the validators to make them take into account the</span>
        <span class="c1"># current state of the instrument</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;data_memory_size&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data memory size&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_MEMSIZE</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_MEMSIZE</span><span class="p">),</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Numbers</span><span class="p">(</span><span class="n">min_value</span><span class="o">=</span><span class="mi">16</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;sets the memory size in samples per channel&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;posttrigger_memory_size&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;posttrigger memory size&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_POSTTRIGGER</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_POSTTRIGGER</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;sets the number of samples to be recorded after trigger event&#39;</span><span class="p">)</span>

        <span class="c1"># FIFO single acquisition length and pretrigger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;pretrigger_memory_size&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pretrigger memory size&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_PRETRIGGER</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_PRETRIGGER</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;sets the number of samples to be recorded before trigger event&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;segment_size&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;segment size&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_SEGMENTSIZE</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_SEGMENTSIZE</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;length of segments to acquire&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;total_segments&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;total segments&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_LOOPS</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_LOOPS</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;number of segments to acquire in total. Setting 0 makes it run until stopped by user&#39;</span><span class="p">)</span>

        <span class="c1"># clock generation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;clock_mode&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;clock mode&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CLOCKMODE</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CLOCKMODE</span><span class="p">),</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CM_INTPLL</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CM_QUARTZ2</span><span class="p">,</span>
                                     <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CM_EXTREFCLOCK</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_CM_PXIREFCLOCK</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;defines the used clock mode or reads out the actual selected one&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;sample_rate&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sample rate&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_SAMPLERATE</span><span class="p">),</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;Hz&#39;</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_SAMPLERATE</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;write the sample rate for internal sample generation or read rate nearest to desired&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;special_clock&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;special clock&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_SPECIALCLOCK</span><span class="p">),</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;Hz&#39;</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_SPECIALCLOCK</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Activate/Deactivate the special clock mode (lower and more sampling clock rates)&#39;</span><span class="p">)</span>

        <span class="c1"># triggering</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;trigger_or_mask&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;trigger or mask&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_ORMASK</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_ORMASK</span><span class="p">),</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TMASK_NONE</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TMASK_SOFTWARE</span><span class="p">,</span>
                                     <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TMASK_EXT0</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TMASK_EXT1</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;defines the events included within the  trigger OR mask card&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;channel_or_mask&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;channel or mask&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_CH_ORMASK0</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_CH_ORMASK0</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;includes the channels (0-31) within the channel trigger OR mask of the card&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;trigger_and_mask&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;trigger and mask&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_ANDMASK</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_ANDMASK</span><span class="p">),</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TMASK_NONE</span><span class="p">,</span>
                                     <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TMASK_EXT0</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TMASK_EXT1</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;defines the events included within the  trigger AND mask card&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;channel_and_mask&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;channel and mask&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_CH_ANDMASK0</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_CH_ANDMASK0</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;includes the channels (0-31) within the channel trigger AND mask of the card&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;trigger_delay&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;trigger delay&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_DELAY</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_DELAY</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;defines the delay for the detected trigger events&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;external_trigger_mode&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;external trigger mode&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_EXT0_MODE</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_EXT0_MODE</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;defines the external trigger mode for the external SMA connector trigger input&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;external_trigger_termination&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;external trigger termination&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_TERM</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_TERM</span><span class="p">),</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;A 1 sets the 50 Ohm termination, a 0 sets high impedance termination&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;external_trigger_input_coupling&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;external trigger input coupling&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_EXT0_ACDC</span><span class="p">),</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TRIG_EXT0_ACDC</span><span class="p">),</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">Enum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;A 1 sets the AC coupling for the external trigger, a 0 sets DC&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;external_trigger_level_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">),</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;external trigger level </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">),</span>
                               <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_TRIG_EXT0_LEVEL</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">))),</span>
                               <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_TRIG_EXT0_LEVEL</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">))),</span>
                               <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;trigger level </span><span class="si">{}</span><span class="s1"> for external trigger&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;trigger_mode_channel_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;trigger mode channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                               <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_TRIG_CH</span><span class="si">{}</span><span class="s1">_MODE&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                   <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_TRIG_CH</span><span class="si">{}</span><span class="s1">_MODE&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))),</span>
                               <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;sets the trigger mode for channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;trigger_channel_</span><span class="si">{}</span><span class="s1">_level_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">l</span><span class="p">),</span>
                                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;trigger channel </span><span class="si">{}</span><span class="s1"> level </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                       <span class="n">i</span><span class="p">,</span> <span class="n">l</span><span class="p">),</span>
                                   <span class="n">get_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                       <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_TRIG_CH</span><span class="si">{}</span><span class="s1">_LEVEL</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">l</span><span class="p">))),</span>
                                   <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span>
                                       <span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_TRIG_CH</span><span class="si">{}</span><span class="s1">_LEVEL</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">l</span><span class="p">))),</span>
                                   <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;trigger level </span><span class="si">{}</span><span class="s1"> channel </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>

        <span class="c1"># add parameters for setting (write only registers)</span>

        <span class="c1"># Buffer handling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;card_available_length&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;card available length&#39;</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_DATA_AVAIL_CARD_LEN</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;writes the number of bytes that the card can now use for sample data transfer again&#39;</span><span class="p">)</span>

        <span class="c1"># General</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;general_command&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;general command&#39;</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">,</span>
                                           <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_M2CMD</span><span class="p">),</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;executes a command for the card or data transfer&#39;</span><span class="p">)</span>

    <span class="c1"># checks if requirements for the compensation get and set functions are met</span>
    <span class="k">def</span> <span class="nf">_get_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="c1"># if HF enabled</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;input_path_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_ACDC_OFFS_COMPENSATION</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;M4i: HF path not set, ignoring ACDC offset compensation get</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_compensation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># if HF enabled</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;input_path_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_param32bit</span><span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_ACDC_OFFS_COMPENSATION</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;M4i: HF path not set, ignoring ACDC offset compensation set</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="M4i.get_idn"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.get_idn">[docs]</a>    <span class="k">def</span> <span class="nf">get_idn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="s1">&#39;vendor&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;serial&#39;</span><span class="p">,</span> <span class="s1">&#39;firmware&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Spectrum_GMBH&#39;</span><span class="p">,</span> <span class="n">szTypeToName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_card_type</span><span class="p">()),</span> <span class="bp">self</span><span class="o">.</span><span class="n">serial_number</span><span class="p">(),</span> <span class="s1">&#39; &#39;</span><span class="p">)))</span></div>

<div class="viewcode-block" id="M4i.convert_to_voltage"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.convert_to_voltage">[docs]</a>    <span class="k">def</span> <span class="nf">convert_to_voltage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">input_range</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;convert an array of numbers to an array of voltages.&quot;&quot;&quot;</span>
        <span class="n">resolution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ADC_to_voltage</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">data</span> <span class="o">*</span> <span class="n">input_range</span> <span class="o">/</span> <span class="n">resolution</span></div>

<div class="viewcode-block" id="M4i.set_channel_settings"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.set_channel_settings">[docs]</a>    <span class="k">def</span> <span class="nf">set_channel_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">mV_range</span><span class="p">,</span> <span class="n">input_path</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">coupling</span><span class="p">,</span> <span class="n">compensation</span><span class="p">):</span>
        <span class="c1"># initialize</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;input_path_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))(</span><span class="n">input_path</span><span class="p">)</span>  <span class="c1"># 0: 1 MOhm</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;termination_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))(</span><span class="n">termination</span><span class="p">)</span>  <span class="c1"># 0: DC</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ACDC_coupling_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))(</span><span class="n">coupling</span><span class="p">)</span>  <span class="c1"># 0: DC</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;range_channel_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))(</span>
            <span class="n">mV_range</span><span class="p">)</span>  <span class="c1"># note: set after voltage range</span>
        <span class="c1"># can only be used with DC coupling and 50 Ohm path (hf)</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;ACDC_offs_compensation_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))(</span><span class="n">compensation</span><span class="p">)</span></div>

<div class="viewcode-block" id="M4i.set_ext0_OR_trigger_settings"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.set_ext0_OR_trigger_settings">[docs]</a>    <span class="k">def</span> <span class="nf">set_ext0_OR_trigger_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trig_mode</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">coupling</span><span class="p">,</span> <span class="n">level0</span><span class="p">,</span> <span class="n">level1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">channel_or_mask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_trigger_mode</span><span class="p">(</span><span class="n">trig_mode</span><span class="p">)</span>  <span class="c1"># trigger mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_or_mask</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TMASK_EXT0</span><span class="p">)</span>  <span class="c1"># external trigger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_trigger_termination</span><span class="p">(</span><span class="n">termination</span><span class="p">)</span>  <span class="c1"># 1: 50 Ohm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_trigger_input_coupling</span><span class="p">(</span><span class="n">coupling</span><span class="p">)</span>  <span class="c1"># 0: DC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_trigger_level_0</span><span class="p">(</span><span class="n">level0</span><span class="p">)</span>  <span class="c1"># mV</span>
        <span class="k">if</span><span class="p">(</span><span class="n">level1</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">external_trigger_level_1</span><span class="p">(</span><span class="n">level1</span><span class="p">)</span>  <span class="c1"># mV</span></div>

    <span class="c1"># Note: the levels need to be set in bits, not voltages! (between -8191 to</span>
    <span class="c1"># 8191 for 14 bits)</span>
<div class="viewcode-block" id="M4i.set_channel_OR_trigger_settings"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.set_channel_OR_trigger_settings">[docs]</a>    <span class="k">def</span> <span class="nf">set_channel_OR_trigger_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">trig_mode</span><span class="p">,</span> <span class="n">bitlevel0</span><span class="p">,</span> <span class="n">bitlevel1</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When a channel is used for triggering it must be enabled during the</span>
<span class="sd">        acquisition.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_or_mask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_or_mask</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">pyspcm</span><span class="p">,</span> <span class="s1">&#39;SPC_TMASK0_CH</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;trigger_channel_</span><span class="si">{}</span><span class="s1">_level_0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))(</span><span class="n">bitlevel0</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">bitlevel1</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">):</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;trigger_channel_</span><span class="si">{}</span><span class="s1">_level_1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))(</span><span class="n">bitlevel1</span><span class="p">)</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;trigger_mode_channel_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))(</span>
            <span class="n">trig_mode</span><span class="p">)</span>  <span class="c1"># trigger mode</span></div>

    <span class="k">def</span> <span class="nf">_stop_acquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># close acquisition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_DATA_STOPDMA</span><span class="p">)</span>

        <span class="c1"># invalidate buffer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalidate_buf</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPCM_BUF_DATA</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_STOP</span><span class="p">)</span>

    <span class="c1"># TODO: if multiple channels are used at the same time, the voltage conversion needs to be updated</span>
    <span class="c1"># TODO: the data also needs to be organized nicely (currently it</span>
    <span class="c1"># interleaves the data)</span>
<div class="viewcode-block" id="M4i.multiple_trigger_acquisition"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.multiple_trigger_acquisition">[docs]</a>    <span class="k">def</span> <span class="nf">multiple_trigger_acquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mV_range</span><span class="p">,</span> <span class="n">memsize</span><span class="p">,</span> <span class="n">seg_size</span><span class="p">,</span> <span class="n">posttrigger_size</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">card_mode</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_STD_MULTI</span><span class="p">)</span>  <span class="c1"># multi</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_memory_size</span><span class="p">(</span><span class="n">memsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segment_size</span><span class="p">(</span><span class="n">seg_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posttrigger_memory_size</span><span class="p">(</span><span class="n">posttrigger_size</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_START</span> <span class="o">|</span>
                             <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_ENABLETRIGGER</span> <span class="o">|</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_WAITREADY</span><span class="p">)</span>

        <span class="c1"># setup software buffer</span>
        <span class="n">buffer_size</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">c_int16</span> <span class="o">*</span> <span class="n">memsize</span>
        <span class="n">data_buffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">buffer_size</span><span class="p">)()</span>
        <span class="n">data_pointer</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">data_buffer</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>

        <span class="c1"># data acquisition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_def_transfer64bit</span><span class="p">(</span>
            <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPCM_BUF_DATA</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPCM_DIR_CARDTOPC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_pointer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">memsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_DATA_STARTDMA</span> <span class="o">|</span>
                             <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_DATA_WAITDMA</span><span class="p">)</span>

        <span class="c1"># convert buffer to numpy array</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">data_pointer</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">))</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ct</span><span class="o">.</span><span class="n">c_int16</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_acquisition</span><span class="p">()</span>

        <span class="n">voltages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_voltage</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">mV_range</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">voltages</span></div>

<div class="viewcode-block" id="M4i.single_trigger_acquisition"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.single_trigger_acquisition">[docs]</a>    <span class="k">def</span> <span class="nf">single_trigger_acquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mV_range</span><span class="p">,</span> <span class="n">memsize</span><span class="p">,</span> <span class="n">posttrigger_size</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">card_mode</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_STD_SINGLE</span><span class="p">)</span>  <span class="c1"># single</span>

        <span class="c1"># set memsize and posttrigger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_memory_size</span><span class="p">(</span><span class="n">memsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posttrigger_memory_size</span><span class="p">(</span><span class="n">posttrigger_size</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_START</span> <span class="o">|</span>
                             <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_ENABLETRIGGER</span> <span class="o">|</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_WAITREADY</span><span class="p">)</span>

        <span class="c1"># setup software buffer</span>
        <span class="n">buffer_size</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">c_int16</span> <span class="o">*</span> <span class="n">memsize</span>
        <span class="n">data_buffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">buffer_size</span><span class="p">)()</span>
        <span class="n">data_pointer</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">data_buffer</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>

        <span class="c1"># data acquisition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_def_transfer64bit</span><span class="p">(</span>
            <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPCM_BUF_DATA</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPCM_DIR_CARDTOPC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_pointer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">memsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_DATA_STARTDMA</span> <span class="o">|</span>
                             <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_DATA_WAITDMA</span><span class="p">)</span>

        <span class="c1"># convert buffer to numpy array</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">data_pointer</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">))</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ct</span><span class="o">.</span><span class="n">c_int16</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_acquisition</span><span class="p">()</span>

        <span class="n">voltages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_voltage</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">mV_range</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">voltages</span></div>

<div class="viewcode-block" id="M4i.gated_trigger_acquisition"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.gated_trigger_acquisition">[docs]</a>    <span class="k">def</span> <span class="nf">gated_trigger_acquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mV_range</span><span class="p">,</span> <span class="n">memsize</span><span class="p">,</span> <span class="n">pretrigger_size</span><span class="p">,</span> <span class="n">posttrigger_size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;doesn&#39;t work completely as expected, it triggers even when the</span>
<span class="sd">        trigger level is set outside of the signal range it also seems to</span>
<span class="sd">        additionally acquire some wrong parts of the wave, but this also exists</span>
<span class="sd">        in SBench6, so it is not a problem caused by this code.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">card_mode</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_STD_GATE</span><span class="p">)</span>  <span class="c1"># gated</span>

        <span class="c1"># set memsize and posttrigger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_memory_size</span><span class="p">(</span><span class="n">memsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pretrigger_memory_size</span><span class="p">(</span><span class="n">pretrigger_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posttrigger_memory_size</span><span class="p">(</span><span class="n">posttrigger_size</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_START</span> <span class="o">|</span>
                             <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_ENABLETRIGGER</span> <span class="o">|</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_WAITREADY</span><span class="p">)</span>

        <span class="c1"># setup software buffer</span>
        <span class="n">buffer_size</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">c_int16</span> <span class="o">*</span> <span class="n">memsize</span>
        <span class="n">data_buffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">buffer_size</span><span class="p">)()</span>
        <span class="n">data_pointer</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">data_buffer</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>

        <span class="c1"># data acquisition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_def_transfer64bit</span><span class="p">(</span>
            <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPCM_BUF_DATA</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPCM_DIR_CARDTOPC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_pointer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">memsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_DATA_STARTDMA</span> <span class="o">|</span>
                             <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_DATA_WAITDMA</span><span class="p">)</span>

        <span class="c1"># convert buffer to numpy array</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">data_pointer</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">))</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ct</span><span class="o">.</span><span class="n">c_int16</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_acquisition</span><span class="p">()</span>

        <span class="n">voltages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_voltage</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">mV_range</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">voltages</span></div>

<div class="viewcode-block" id="M4i.single_software_trigger_acquisition"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.single_software_trigger_acquisition">[docs]</a>    <span class="k">def</span> <span class="nf">single_software_trigger_acquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mV_range</span><span class="p">,</span> <span class="n">memsize</span><span class="p">,</span> <span class="n">posttrigger_size</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">card_mode</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_REC_STD_SINGLE</span><span class="p">)</span>  <span class="c1"># single</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_memory_size</span><span class="p">(</span><span class="n">memsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">posttrigger_memory_size</span><span class="p">(</span><span class="n">posttrigger_size</span><span class="p">)</span>

        <span class="c1"># start/enable trigger/wait ready</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_or_mask</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_TMASK_SOFTWARE</span><span class="p">)</span>  <span class="c1"># software trigger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_START</span> <span class="o">|</span>
                             <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_ENABLETRIGGER</span> <span class="o">|</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_CARD_WAITREADY</span><span class="p">)</span>

        <span class="c1"># setup software buffer</span>
        <span class="n">buffer_size</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">c_int16</span> <span class="o">*</span> <span class="n">memsize</span>
        <span class="n">data_buffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">buffer_size</span><span class="p">)()</span>
        <span class="n">data_pointer</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">data_buffer</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>

        <span class="c1"># data acquisition</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_def_transfer64bit</span><span class="p">(</span>
            <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPCM_BUF_DATA</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPCM_DIR_CARDTOPC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_pointer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">memsize</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general_command</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_DATA_STARTDMA</span> <span class="o">|</span>
                             <span class="n">pyspcm</span><span class="o">.</span><span class="n">M2CMD_DATA_WAITDMA</span><span class="p">)</span>

        <span class="c1"># convert buffer to numpy array</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">data_pointer</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">))</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">contents</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ct</span><span class="o">.</span><span class="n">c_int16</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_acquisition</span><span class="p">()</span>

        <span class="n">voltages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_voltage</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">mV_range</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">voltages</span></div>

<div class="viewcode-block" id="M4i.close"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close handle to the card.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hCard</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_vClose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hCard</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hCard</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="M4i.get_card_type"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.get_card_type">[docs]</a>    <span class="k">def</span> <span class="nf">get_card_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read card type.&quot;&quot;&quot;</span>
        <span class="c1"># read type, function and sn and check for D/A card</span>
        <span class="n">lCardType</span> <span class="o">=</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_dwGetParam_i32</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hCard</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_PCITYP</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">lCardType</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;card_type: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">szTypeToName</span><span class="p">(</span><span class="n">lCardType</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">lCardType</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>

    <span class="c1"># only works if the error was not caused by running the entire program</span>
    <span class="c1"># (and therefore making a new M4i object)</span>
<div class="viewcode-block" id="M4i.get_error_info32bit"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.get_error_info32bit">[docs]</a>    <span class="k">def</span> <span class="nf">get_error_info32bit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read an error from the error register.&quot;&quot;&quot;</span>
        <span class="n">dwErrorReg</span> <span class="o">=</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">uint32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">lErrorValue</span> <span class="o">=</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_dwGetErrorInfo_i32</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hCard</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span>
            <span class="n">dwErrorReg</span><span class="p">),</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">lErrorValue</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">dwErrorReg</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">lErrorValue</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_param64bit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read a 64-bit parameter from the device.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_dwGetParam_i64</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hCard</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_param32bit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read a 32-bit parameter from the device.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_dwGetParam_i32</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hCard</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_param32bit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read a 32-bit parameter from the device.&quot;&quot;&quot;</span>
        <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_dwSetParam_i32</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hCard</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_invalidate_buf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Invalidate device buffer.&quot;&quot;&quot;</span>
        <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_dwInvalidateBuf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hCard</span><span class="p">,</span> <span class="n">buf_type</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_def_transfer64bit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer_type</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">bytes_till_event</span><span class="p">,</span> <span class="n">data_pointer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Define a 64-bit transer between the device and the computer.&quot;&quot;&quot;</span>
        <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_dwDefTransfer_i64</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hCard</span><span class="p">,</span> <span class="n">buffer_type</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">bytes_till_event</span><span class="p">,</span> <span class="n">data_pointer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">)</span>

<div class="viewcode-block" id="M4i.get_max_sample_rate"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.get_max_sample_rate">[docs]</a>    <span class="k">def</span> <span class="nf">get_max_sample_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return max sample rate.&quot;&quot;&quot;</span>
        <span class="c1"># read type, function and sn and check for D/A card</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param32bit</span><span class="p">(</span><span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_PCISAMPLERATE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;max_sample_rate: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="M4i.get_card_memory"><a class="viewcode-back" href="../../../../api/generated/qcodes.instrument_drivers.Spectrum.html#qcodes.instrument_drivers.Spectrum.M4i.M4i.get_card_memory">[docs]</a>    <span class="k">def</span> <span class="nf">get_card_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pyspcm</span><span class="o">.</span><span class="n">spcm_dwGetParam_i64</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hCard</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">SPC_PCIMEMSIZE</span><span class="p">,</span> <span class="n">pyspcm</span><span class="o">.</span><span class="n">byref</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;card_memory: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'0.1.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>