

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Creating QCoDeS instrument drivers &mdash; QCoDeS 0.5.1+83.g225985811 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Creating Simulated PyVISA Instruments" href="Creating-Simulated-PyVISA-Instruments.html" />
    <link rel="prev" title="A ParameterWithSetpoints Example with Dual Setpoints" href="A-ParameterWithSetpoints-Example-with-Dual-Setpoints.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> QCoDeS
          

          
          </a>

          
            
            
              <div class="version">
                0.5.1+83.g225985811
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">Get Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataset/index.html">DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">QCoDes API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/generated/qcodes.instrument_drivers.html">qcodes.instrument_drivers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes/index.html">Changelogs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples of using QCoDeS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#basic-examples">Basic examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#parameters">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#dataset">DataSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#plotting">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#drivers">Drivers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#writing-drivers">Writing Drivers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="A-ParameterWithSetpoints-Example-with-Dual-Setpoints.html">A ParameterWithSetpoints Example with Dual Setpoints</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Creating QCoDeS instrument drivers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Base-Classes">Base Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Parameters-and-Channels">Parameters and Channels</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Logging">Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#VisaInstrument:-Simple-example">VisaInstrument: Simple example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#VisaInstrument:-a-more-involved-example">VisaInstrument: a more involved example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#VisaInstruments:-Simulating-the-instrument">VisaInstruments: Simulating the instrument</a></li>
<li class="toctree-l4"><a class="reference internal" href="#DLL-based-instruments">DLL-based instruments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Manual-instruments">Manual instruments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Custom-Parameter-classes">Custom Parameter classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Dynamically-adding-and-removing-parameters">Dynamically adding and removing parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Organization">Organization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Creating-Simulated-PyVISA-Instruments.html">Creating Simulated PyVISA Instruments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#legacy-examples">Legacy examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QCoDeS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Examples of using QCoDeS</a> &raquo;</li>
        
      <li>Creating QCoDeS instrument drivers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/examples/writing_drivers/Creating-Instrument-Drivers.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Creating-QCoDeS-instrument-drivers">
<h1>Creating QCoDeS instrument drivers<a class="headerlink" href="#Creating-QCoDeS-instrument-drivers" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># most of the drivers only need a couple of these... moved all up here for clarity below</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">sleep</span><span class="p">,</span> <span class="n">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">ctypes</span>  <span class="c1"># only for DLL-based instrument</span>

<span class="kn">import</span> <span class="nn">qcodes</span> <span class="k">as</span> <span class="nn">qc</span>
<span class="kn">from</span> <span class="nn">qcodes</span> <span class="k">import</span> <span class="p">(</span><span class="n">Instrument</span><span class="p">,</span> <span class="n">VisaInstrument</span><span class="p">,</span>
                    <span class="n">ManualParameter</span><span class="p">,</span> <span class="n">MultiParameter</span><span class="p">,</span>
                    <span class="n">validators</span> <span class="k">as</span> <span class="n">vals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">qcodes.instrument.channel</span> <span class="k">import</span> <span class="n">InstrumentChannel</span>
</pre></div>
</div>
</div>
<div class="section" id="Base-Classes">
<h2>Base Classes<a class="headerlink" href="#Base-Classes" title="Permalink to this headline">¶</a></h2>
<p>There are 3 available: - <code class="docutils literal notranslate"><span class="pre">VisaInstrument</span></code> - for most instruments that communicate over a text channel (ethernet, GPIB, serial, USB…) that do not have a custom DLL or other driver to manage low-level commands. - <code class="docutils literal notranslate"><span class="pre">IPInstrument</span></code> - a deprecated driver just for ethernet connections. Do not use this; use <code class="docutils literal notranslate"><span class="pre">VisaInstrument</span></code> instead. - <code class="docutils literal notranslate"><span class="pre">Instrument</span></code> - superclass of both <code class="docutils literal notranslate"><span class="pre">VisaInstrument</span></code> and <code class="docutils literal notranslate"><span class="pre">IPInstrument</span></code>, use this if you do not communicate over a text channel, for example: - PCI cards with
their own DLLs - Instruments with only manual controls.</p>
<p>If possible, please use a <code class="docutils literal notranslate"><span class="pre">VisaInstrument</span></code>, as this allows for the creation of a simulated instrument. (See the <a class="reference internal" href="Creating-Simulated-PyVISA-Instruments.html"><span class="doc">Creating Simulated PyVISA Instruments</span></a> notebook)</p>
</div>
<div class="section" id="Parameters-and-Channels">
<h2>Parameters and Channels<a class="headerlink" href="#Parameters-and-Channels" title="Permalink to this headline">¶</a></h2>
<p>Broadly speaking, a QCoDeS instrument driver is nothing but an object that holds a connection handle to the physical instrument and has some sub-objects that represent the state of the physical instrument. These sub-objects are the <code class="docutils literal notranslate"><span class="pre">Parameters</span></code>. Writing a driver basically boils down to adding a ton of <code class="docutils literal notranslate"><span class="pre">Parameters</span></code>.</p>
<div class="section" id="What’s-a-Parameter?">
<h3>What’s a Parameter?<a class="headerlink" href="#What’s-a-Parameter?" title="Permalink to this headline">¶</a></h3>
<p>A parameter represents a single value of a single feature of an instrument, e.g. the frequency of a function generator, the mode of a multimeter (resistance, current, or voltage), or the input impedance of an oscilloscope channel. Each <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> can have the following attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>, the name used internally by QCoDeS, e.g. ‘input_impedance’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code>, the label to use for plotting this parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unit</span></code>, the physical unit. ALWAYS use SI units if a unit is applicable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_cmd</span></code>, the command to set the parameter. Either a SCPI string with a single ‘{}’, or a function taking one argument (see examples below)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_cmd</span></code>, the command to get the parameter. Follows the same scheme as <code class="docutils literal notranslate"><span class="pre">set_cmd</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vals</span></code>, a validator (from <code class="docutils literal notranslate"><span class="pre">qcodes.utils.validators</span></code>) to reject invalid values before they are sent to the instrument. Since there is no standard for how an instrument responds to an out-of-bound value (e.g. a 10 kHz function generator receiving 12e9 for its frequency), meaning that the user can expect anything from silent failure to the instrument breaking or suddenly outputting random noise, it is MUCH better to catch invalid values in software. Therefore, please provide a validator if
at all possible.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">val_mapping</span></code>, a dictionary mapping human-readable values like ‘High Impedance’ to the instrument’s internal representation like ‘372’. Not always needed. If supplied, a validator is automatically constructed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_parser</span></code>, a parser of the raw return value. Since all VISA instruments return strings, but users usually want numbers, <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">float</span></code> are popular <code class="docutils literal notranslate"><span class="pre">get_parsers</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">docstring</span></code> A short string describing the function of the parameter</p></li>
</ul>
<p>Golden rule: if a <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> is settable, it must always accept its own output as input.</p>
<p>In most cases you will probably be adding parameters via the <code class="docutils literal notranslate"><span class="pre">add_parameter</span></code> method on the instrument class as shown in the example below.</p>
</div>
<div class="section" id="Functions">
<h3>Functions<a class="headerlink" href="#Functions" title="Permalink to this headline">¶</a></h3>
<p>Similar to parameters QCoDeS instruments implement the concept of functions that can be added to the instrument via <code class="docutils literal notranslate"><span class="pre">add_function</span></code>. They are meant to implement simple actions on the instrument such as resetting it. However, the functions do not add any value over normal python methods in the driver Class and we are planning to eventually remove them from QCoDeS. <strong>We therefore encourage any driver developer to not use function in any new driver</strong>.</p>
</div>
<div class="section" id="What’s-a-Channel,-then?">
<h3>What’s a Channel, then?<a class="headerlink" href="#What’s-a-Channel,-then?" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Channel</span></code> is a submodule holding <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>s. It sometimes makes sense to group <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>s, for instance when an oscilloscope has four identical input channels. (see Keithley example below)</p>
</div>
</div>
<div class="section" id="Logging">
<h2>Logging<a class="headerlink" href="#Logging" title="Permalink to this headline">¶</a></h2>
<p>Every QCoDeS module should have its own logger that is named with the name of the module. So to create a logger put a line at the top of the module like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p>Use this logger only to log messages that are not originating from an <code class="docutils literal notranslate"><span class="pre">Instrument</span></code> instance. For messages from within an instrument instance use the <code class="docutils literal notranslate"><span class="pre">log</span></code> member of the <code class="docutils literal notranslate"><span class="pre">Instrument</span></code> class, e.g</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Could not connect at </span><span class="si">{address}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This way the instrument name will be prepended to the log message and the log messages can be filtered according to the instrument they originate from. See the example notebook of the logger module for more info (<a class="reference internal" href="../logging/logging_example.html"><span class="doc">offline</span></a>,<a class="reference external" href="https://nbviewer.jupyter.org/github/QCoDeS/Qcodes/tree/master/docs/examples/logging/logging_example.ipynb">online</a>).</p>
<p>When creating a nested <code class="docutils literal notranslate"><span class="pre">Instrument</span></code>, like e.g. something like the <code class="docutils literal notranslate"><span class="pre">InstrumentChannel</span></code> class, that has a <code class="docutils literal notranslate"><span class="pre">_parent</span></code> property, make sure that this property gets set before calling the <code class="docutils literal notranslate"><span class="pre">super().__init__</span></code> method, so that the full name of the instrument gets resolved correctly for the logging.</p>
</div>
<div class="section" id="VisaInstrument:-Simple-example">
<h2>VisaInstrument: Simple example<a class="headerlink" href="#VisaInstrument:-Simple-example" title="Permalink to this headline">¶</a></h2>
<p>The Weinschel 8320 driver is about as basic a driver as you can get. It only defines one parameter, “attenuation”. All the comments here are my additions to describe what’s happening.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Weinschel_8320</span><span class="p">(</span><span class="n">VisaInstrument</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    QCoDeS driver for the stepped attenuator</span>
<span class="sd">    Weinschel is formerly known as Aeroflex/Weinschel</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># all instrument constructors should accept **kwargs and pass them on to</span>
    <span class="c1"># super().__init__</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># supplying the terminator means you don&#39;t need to remove it from every response</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">terminator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;attenuation&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;dB&#39;</span><span class="p">,</span>
                           <span class="c1"># the value you set will be inserted in this command with</span>
                           <span class="c1"># regular python string substitution. This instrument wants</span>
                           <span class="c1"># an integer zero-padded to 2 digits. For robustness, don&#39;t</span>
                           <span class="c1"># assume you&#39;ll get an integer input though - try to allow</span>
                           <span class="c1"># floats (as opposed to {:0=2d})</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="s1">&#39;ATTN ALL </span><span class="si">{:02.0f}</span><span class="s1">&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="s1">&#39;ATTN? 1&#39;</span><span class="p">,</span>
                           <span class="c1"># setting any attenuation other than 0, 2, ... 60 will error.</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">vals</span><span class="o">.</span><span class="n">Enum</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">60.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
                           <span class="c1"># the return value of get() is a string, but we want to</span>
                           <span class="c1"># turn it into a (float) number</span>
                           <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="c1"># it&#39;s a good idea to call connect_message at the end of your constructor.</span>
        <span class="c1"># this calls the &#39;IDN&#39; parameter that the base Instrument class creates for</span>
        <span class="c1"># every instrument (you can override the `get_idn` method if it doesn&#39;t work</span>
        <span class="c1"># in the standard VISA form for your instrument) which serves two purposes:</span>
        <span class="c1"># 1) verifies that you are connected to the instrument</span>
        <span class="c1"># 2) gets the ID info so it will be included with metadata snapshots later.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_message</span><span class="p">()</span>

<span class="c1"># instantiating and using this instrument (commented out because I can&#39;t actually do it!)</span>
<span class="c1">#</span>
<span class="c1"># from qcodes.instrument_drivers.weinschel.Weinschel_8320 import Weinschel_8320</span>
<span class="c1"># weinschel = Weinschel_8320(&#39;w8320_1&#39;, &#39;TCPIP0::172.20.2.212::inst0::INSTR&#39;)</span>
<span class="c1"># weinschel.attenuation(40)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="VisaInstrument:-a-more-involved-example">
<h2>VisaInstrument: a more involved example<a class="headerlink" href="#VisaInstrument:-a-more-involved-example" title="Permalink to this headline">¶</a></h2>
<p>The Keithley 2600 sourcemeter driver uses two channels. The actual driver is quite long, so here we show an abridged version that has:</p>
<ul class="simple">
<li><p>A class defining a <code class="docutils literal notranslate"><span class="pre">Channel</span></code>. All the <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>s of the <code class="docutils literal notranslate"><span class="pre">Channel</span></code> go here.</p></li>
<li><p>A nifty way to look up the model number, allowing it to be a driver for many different Keithley models</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">KeithleyChannel</span><span class="p">(</span><span class="n">InstrumentChannel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to hold the two Keithley channels, i.e.</span>
<span class="sd">    SMUA and SMUB.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Instrument</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">channel</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            parent: The Instrument instance to which the channel is</span>
<span class="sd">                to be attached.</span>
<span class="sd">            name: The &#39;colloquial&#39; name of the channel</span>
<span class="sd">            channel: The name used by the Keithley, i.e. either</span>
<span class="sd">                &#39;smua&#39; or &#39;smub&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">channel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;smua&#39;</span><span class="p">,</span> <span class="s1">&#39;smub&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;channel must be either &quot;smub&quot; or &quot;smua&quot;&#39;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">model</span>
        <span class="n">vranges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_vranges</span>
        <span class="n">iranges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_iranges</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;volt&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.measure.v()&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">),</span>
                           <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.source.levelv=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span>
                                                                <span class="s1">&#39;</span><span class="si">{:.12f}</span><span class="s1">&#39;</span><span class="p">),</span>
                           <span class="c1"># note that the set_cmd is either the following format string</span>
                           <span class="c1">#&#39;smua.source.levelv={:.12f}&#39; or &#39;smub.source.levelv={:.12f}&#39;</span>
                           <span class="c1"># depending on the value of `channel`</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Voltage&#39;</span><span class="p">,</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;curr&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.measure.i()&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">),</span>
                           <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.source.leveli=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span>
                                                                <span class="s1">&#39;</span><span class="si">{:.12f}</span><span class="s1">&#39;</span><span class="p">),</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Current&#39;</span><span class="p">,</span>
                           <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.source.func&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">),</span>
                           <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.source.func=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">),</span>
                           <span class="n">val_mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;current&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;voltage&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                           <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;Selects the output source.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.source.output&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">),</span>
                           <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.source.output=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span>
                                                                <span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">),</span>
                           <span class="n">val_mapping</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;on&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;off&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;nplc&#39;</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of power line cycles&#39;</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.measure.nplc=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span>
                                                               <span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="p">),</span>
                           <span class="n">get_cmd</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.measure.nplc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel</span><span class="p">),</span>
                           <span class="n">get_parser</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">vals</span><span class="o">.</span><span class="n">Numbers</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">channel</span>


<span class="k">class</span> <span class="nc">Keithley_2600</span><span class="p">(</span><span class="n">VisaInstrument</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the qcodes driver for the Keithley_2600 Source-Meter series,</span>
<span class="sd">    tested with Keithley_2614B</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            name: Name to use internally in QCoDeS</span>
<span class="sd">            address: VISA ressource address</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">terminator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s1">&#39;localnode.model&#39;</span><span class="p">)</span>

        <span class="n">knownmodels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2601B&#39;</span><span class="p">,</span> <span class="s1">&#39;2602B&#39;</span><span class="p">,</span> <span class="s1">&#39;2604B&#39;</span><span class="p">,</span> <span class="s1">&#39;2611B&#39;</span><span class="p">,</span> <span class="s1">&#39;2612B&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;2614B&#39;</span><span class="p">,</span> <span class="s1">&#39;2635B&#39;</span><span class="p">,</span> <span class="s1">&#39;2636B&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">model</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">knownmodels</span><span class="p">:</span>
            <span class="n">kmstring</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, &#39;</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">knownmodels</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">knownmodels</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">kmstring</span> <span class="o">+=</span> <span class="s1">&#39;and </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">knownmodels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown model. Known model are: &#39;</span> <span class="o">+</span> <span class="n">kmstring</span><span class="p">)</span>

        <span class="c1"># Add the channel to the instrument</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]:</span>
            <span class="n">ch_name</span> <span class="o">=</span> <span class="s1">&#39;smu</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">KeithleyChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ch_name</span><span class="p">,</span> <span class="n">ch_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_submodule</span><span class="p">(</span><span class="n">ch_name</span><span class="p">,</span> <span class="n">channel</span><span class="p">)</span>

        <span class="c1"># display parameter</span>
        <span class="c1"># Parameters NOT specific to a channel still belong on the Instrument object</span>
        <span class="c1"># In this case, the Parameter controls the text on the display</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;display_settext&#39;</span><span class="p">,</span>
                           <span class="n">set_cmd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_display_settext</span><span class="p">,</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">vals</span><span class="o">.</span><span class="n">Strings</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connect_message</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="VisaInstruments:-Simulating-the-instrument">
<h2>VisaInstruments: Simulating the instrument<a class="headerlink" href="#VisaInstruments:-Simulating-the-instrument" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, drivers subclassing <code class="docutils literal notranslate"><span class="pre">VisaInstrument</span></code> have the nice property that they may be connected to a simulated version of the physical instrument. See the <a class="reference internal" href="Creating-Simulated-PyVISA-Instruments.html"><span class="doc">Creating Simulated PyVISA Instruments</span></a> notebook for more information. If you are writing a <code class="docutils literal notranslate"><span class="pre">VisaInstrument</span></code> driver, please consider spending 20 minutes to also add a simulated instrument and a test.</p>
</div>
<div class="section" id="DLL-based-instruments">
<h2>DLL-based instruments<a class="headerlink" href="#DLL-based-instruments" title="Permalink to this headline">¶</a></h2>
<p>The Alazar cards use their own DLL. C interfaces tend to need a lot of boilerplate, so I’m not going to include it all. The key is: use <code class="docutils literal notranslate"><span class="pre">Instrument</span></code> directly, load the DLL, and have parameters interact with it.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">AlazarTech_ATS</span><span class="p">(</span><span class="n">Instrument</span><span class="p">):</span>
    <span class="n">dll_path</span> <span class="o">=</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">WINDOWS</span><span class="se">\\</span><span class="s1">System32</span><span class="se">\\</span><span class="s1">ATSApi&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">system_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">board_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dll_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># connect to the DLL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ATS_dll</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cdll</span><span class="o">.</span><span class="n">LoadLibrary</span><span class="p">(</span><span class="n">dll_path</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dll_path</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ATS_dll</span><span class="o">.</span><span class="n">AlazarGetBoardBySystemID</span><span class="p">(</span><span class="n">system_id</span><span class="p">,</span>
                                                              <span class="n">board_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;AlazarTech_ATS not found at &#39;</span>
                            <span class="s1">&#39;system </span><span class="si">{}</span><span class="s1">, board </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">system_id</span><span class="p">,</span> <span class="n">board_id</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">buffer_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># the Alazar driver includes its own parameter class to hold values</span>
        <span class="c1"># until later config is called, and warn if you try to read a value</span>
        <span class="c1"># that hasn&#39;t been sent to config.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;clock_source&#39;</span><span class="p">,</span>
                           <span class="n">parameter_class</span><span class="o">=</span><span class="n">AlazarParameter</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Clock Source&#39;</span><span class="p">,</span>
                           <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">value</span><span class="o">=</span><span class="s1">&#39;INTERNAL_CLOCK&#39;</span><span class="p">,</span>
                           <span class="n">byte_to_value_dict</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;INTERNAL_CLOCK&#39;</span><span class="p">,</span>
                                               <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;SLOW_EXTERNAL_CLOCK&#39;</span><span class="p">,</span>
                                               <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;EXTERNAL_CLOCK_AC&#39;</span><span class="p">,</span>
                                               <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;EXTERNAL_CLOCK_10_MHz_REF&#39;</span><span class="p">})</span>

        <span class="c1"># etc...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Manual-instruments">
<h2>Manual instruments<a class="headerlink" href="#Manual-instruments" title="Permalink to this headline">¶</a></h2>
<p>A totally manual instrument (like the ithaco 1211) will contain only <code class="docutils literal notranslate"><span class="pre">ManualParameter</span></code>s. Some instruments may have a mix of manual and standard parameters. Here we also define a new <code class="docutils literal notranslate"><span class="pre">CurrentParameter</span></code> class that uses the ithaco parameters to convert a measured voltage to a current. When subclassing a parameter class (<code class="docutils literal notranslate"><span class="pre">Parameter</span></code>, <code class="docutils literal notranslate"><span class="pre">MultiParameter</span></code>, …), the functions for setting and getting should be called <code class="docutils literal notranslate"><span class="pre">get_raw</span></code> and <code class="docutils literal notranslate"><span class="pre">set_raw</span></code>, respectively.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">CurrentParameter</span><span class="p">(</span><span class="n">MultiParameter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Current measurement via an Ithaco preamp and a measured voltage.</span>

<span class="sd">    To be used when you feed a current into the Ithaco, send the Ithaco&#39;s</span>
<span class="sd">    output voltage to a lockin or other voltage amplifier, and you have</span>
<span class="sd">    the voltage reading from that amplifier as a qcodes parameter.</span>

<span class="sd">    ``CurrentParameter.get()`` returns ``(voltage_raw, current)``</span>

<span class="sd">    Args:</span>
<span class="sd">        measured_param (Parameter): a gettable parameter returning the</span>
<span class="sd">            voltage read from the Ithaco output.</span>

<span class="sd">        c_amp_ins (Ithaco_1211): an Ithaco instance where you manually</span>
<span class="sd">            maintain the present settings of the real Ithaco amp.</span>

<span class="sd">        name (str): the name of the current output. Default &#39;curr&#39;.</span>
<span class="sd">            Also used as the name of the whole parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measured_param</span><span class="p">,</span> <span class="n">c_amp_ins</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;curr&#39;</span><span class="p">):</span>
        <span class="n">p_name</span> <span class="o">=</span> <span class="n">measured_param</span><span class="o">.</span><span class="n">name</span>

        <span class="n">p_label</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">measured_param</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">p_unit</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">measured_param</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="n">p_name</span><span class="o">+</span><span class="s1">&#39;_raw&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span>
                         <span class="n">shapes</span><span class="o">=</span><span class="p">((),</span> <span class="p">()),</span>
                         <span class="n">labels</span><span class="o">=</span><span class="p">(</span><span class="n">p_label</span><span class="p">,</span> <span class="s1">&#39;Current&#39;</span><span class="p">),</span>
                         <span class="n">units</span><span class="o">=</span><span class="p">(</span><span class="n">p_unit</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_measured_param</span> <span class="o">=</span> <span class="n">measured_param</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_instrument</span> <span class="o">=</span> <span class="n">c_amp_ins</span>

    <span class="k">def</span> <span class="nf">get_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">volt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_measured_param</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">current</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_instrument</span><span class="o">.</span><span class="n">sens</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">*</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">_instrument</span><span class="o">.</span><span class="n">sens_factor</span><span class="o">.</span><span class="n">get</span><span class="p">())</span> <span class="o">*</span> <span class="n">volt</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instrument</span><span class="o">.</span><span class="n">invert</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">current</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">volt</span><span class="p">,</span> <span class="n">current</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_val</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>


<span class="k">class</span> <span class="nc">Ithaco_1211</span><span class="p">(</span><span class="n">Instrument</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the qcodes driver for the Ithaco 1211 Current-preamplifier.</span>

<span class="sd">    This is a virtual driver only and will not talk to your instrument.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># ManualParameter has an &quot;initial_value&quot; kwarg, but if you use this</span>
        <span class="c1"># you must be careful to check that it&#39;s correct before relying on it.</span>
        <span class="c1"># if you don&#39;t set initial_value, it will start out as None.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;sens&#39;</span><span class="p">,</span>
                           <span class="n">parameter_class</span><span class="o">=</span><span class="n">ManualParameter</span><span class="p">,</span>
                           <span class="n">initial_value</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sensitivity&#39;</span><span class="p">,</span>
                           <span class="n">units</span><span class="o">=</span><span class="s1">&#39;A/V&#39;</span><span class="p">,</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">vals</span><span class="o">.</span><span class="n">Enum</span><span class="p">(</span><span class="mf">1e-11</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-09</span><span class="p">,</span> <span class="mf">1e-08</span><span class="p">,</span> <span class="mf">1e-07</span><span class="p">,</span>
                                          <span class="mf">1e-06</span><span class="p">,</span> <span class="mf">1e-05</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;invert&#39;</span><span class="p">,</span>
                           <span class="n">parameter_class</span><span class="o">=</span><span class="n">ManualParameter</span><span class="p">,</span>
                           <span class="n">initial_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Inverted output&#39;</span><span class="p">,</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">vals</span><span class="o">.</span><span class="n">Bool</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;sens_factor&#39;</span><span class="p">,</span>
                           <span class="n">parameter_class</span><span class="o">=</span><span class="n">ManualParameter</span><span class="p">,</span>
                           <span class="n">initial_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sensitivity factor&#39;</span><span class="p">,</span>
                           <span class="n">units</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">vals</span><span class="o">.</span><span class="n">Enum</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;suppression&#39;</span><span class="p">,</span>
                           <span class="n">parameter_class</span><span class="o">=</span><span class="n">ManualParameter</span><span class="p">,</span>
                           <span class="n">initial_value</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Suppression&#39;</span><span class="p">,</span>
                           <span class="n">units</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">vals</span><span class="o">.</span><span class="n">Enum</span><span class="p">(</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-09</span><span class="p">,</span> <span class="mf">1e-08</span><span class="p">,</span> <span class="mf">1e-07</span><span class="p">,</span> <span class="mf">1e-06</span><span class="p">,</span>
                                          <span class="mf">1e-05</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s1">&#39;risetime&#39;</span><span class="p">,</span>
                           <span class="n">parameter_class</span><span class="o">=</span><span class="n">ManualParameter</span><span class="p">,</span>
                           <span class="n">initial_value</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rise Time&#39;</span><span class="p">,</span>
                           <span class="n">units</span><span class="o">=</span><span class="s1">&#39;msec&#39;</span><span class="p">,</span>
                           <span class="n">vals</span><span class="o">=</span><span class="n">vals</span><span class="o">.</span><span class="n">Enum</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span>
                                          <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_idn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;vendor&#39;</span><span class="p">:</span> <span class="s1">&#39;Ithaco (DL Instruments)&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;1211&#39;</span><span class="p">,</span>
                <span class="s1">&#39;serial&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;firmware&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Custom-Parameter-classes">
<h2>Custom Parameter classes<a class="headerlink" href="#Custom-Parameter-classes" title="Permalink to this headline">¶</a></h2>
<p>When you call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>you create a <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>. But with the <code class="docutils literal notranslate"><span class="pre">parameter_class</span></code> kwarg you can invoke any class you want:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parameter_class</span><span class="o">=</span><span class="n">OtherClass</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Parameter</span></code> handles most common instrument settings and measurements.</p>
<ul>
<li><p>Accepts get and/or set commands as either strings for the instrument’s <code class="docutils literal notranslate"><span class="pre">ask</span></code> and <code class="docutils literal notranslate"><span class="pre">write</span></code> methods, or functions/methods. The set and get commands may also be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">None</span></code>. <code class="docutils literal notranslate"><span class="pre">False</span></code> corresponds to “no get/set method available” (example: the reading of a voltmeter is not settable, so we set <code class="docutils literal notranslate"><span class="pre">set_cmd=False</span></code>). <code class="docutils literal notranslate"><span class="pre">None</span></code> corresponds to a manually updated parameter (example: an instrument with no remote interface).</p></li>
<li><p>Has options for translating between instrument codes and more meaningful data values</p></li>
<li><p>Supports software-controlled ramping</p></li>
</ul>
</li>
<li><p>Any other parameter class may be used in <code class="docutils literal notranslate"><span class="pre">add_parameter</span></code>, if it accepts <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">instrument</span></code> as constructor kwargs. Generally these should subclasses of <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>, <code class="docutils literal notranslate"><span class="pre">ParameterWithSetpoints</span></code>, <code class="docutils literal notranslate"><span class="pre">ArrayParameter</span></code>, or <code class="docutils literal notranslate"><span class="pre">MultiParameter</span></code>.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">ParameterWithSetpoints</span></code> is specifically designed to handle the situations where the instrument returns an array of data with assosiated setpoints. An example of how to use it can be found in the notebook <a class="reference internal" href="../Parameters/Simple-Example-of-ParameterWithSetpoints.html"><span class="doc">Simple Example of ParameterWithSetpoints</span></a></p>
<p><code class="docutils literal notranslate"><span class="pre">ArrayParameter</span></code> is an older alternative that does the same thing. However, it is significantly less flexible and much harder to use correct but used in a significant number of drivers. <strong>It is not recommended for any new driver.</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">MultiParameter</span></code> is designed to for the situation where multiple different types of data is captured from the same instrument command.</p>
<div class="section" id="On/Off-parameters">
<h3>On/Off parameters<a class="headerlink" href="#On/Off-parameters" title="Permalink to this headline">¶</a></h3>
<p>Frequently, an instrument has parameters which can be expressed in terms of “something is on or off”. Moreover, usually it is not easy to translate the lingo of the instrument to something that can have simply the value of <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> (which are typical in software). Even further, it may be difficult to find consensus between users on a convention: is it <code class="docutils literal notranslate"><span class="pre">on</span></code>/<code class="docutils literal notranslate"><span class="pre">off</span></code>, or <code class="docutils literal notranslate"><span class="pre">ON</span></code>/<code class="docutils literal notranslate"><span class="pre">OFF</span></code>, or python <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code>, or <code class="docutils literal notranslate"><span class="pre">1</span></code>/<code class="docutils literal notranslate"><span class="pre">0</span></code>, or else?</p>
<p>This case becomes even more complex if the instrument’s API (say, corresponding VISA command) uses unexpected values for such a parameter, for example, turning an output “on” corresponds to a VISA command <code class="docutils literal notranslate"><span class="pre">DEV:CH:BLOCK</span> <span class="pre">0</span></code> which means “set blocking of the channel to 0 where 0 has the meaning of the boolean value False, and alltogether this command actually enables the output on this channel”.</p>
<p>This results in inconsistency among instrument drivers where for some instrument, say, a <code class="docutils literal notranslate"><span class="pre">display</span></code> parameter has ‘on’/‘off’ values for input, while for a different instrument a similar <code class="docutils literal notranslate"><span class="pre">display</span></code> parameter has <code class="docutils literal notranslate"><span class="pre">'ON'</span></code>/<code class="docutils literal notranslate"><span class="pre">'OFF'</span></code> values or <code class="docutils literal notranslate"><span class="pre">1</span></code>/<code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>Note that this particular example of a <code class="docutils literal notranslate"><span class="pre">display</span></code> parameter is trivial because the ambiguity and inconsistency for “this kind” of parameters can be solved by having the name of the parameter be <code class="docutils literal notranslate"><span class="pre">display_enabled</span></code> and the allowed input values to be python <code class="docutils literal notranslate"><span class="pre">bool</span></code> <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Anyway, when defining parameters where the solution does not come trivially, please, consider setting <code class="docutils literal notranslate"><span class="pre">val_mapping</span></code> of a parameter to the output of <code class="docutils literal notranslate"><span class="pre">create_on_off_val_mapping(on_val=&lt;&gt;,</span> <span class="pre">off_val=&lt;&gt;)</span></code> function from <code class="docutils literal notranslate"><span class="pre">qcodes.utils.helpers</span></code> package. The function takes care of creating a <code class="docutils literal notranslate"><span class="pre">val_mapping</span></code> dictionary that maps given instrument-side values of <code class="docutils literal notranslate"><span class="pre">on_val</span></code> and <code class="docutils literal notranslate"><span class="pre">off_val</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">'ON'</span></code>/<code class="docutils literal notranslate"><span class="pre">'OFF'</span></code>, <code class="docutils literal notranslate"><span class="pre">'on'</span></code>/<code class="docutils literal notranslate"><span class="pre">'off'</span></code>, and other commonly used ones. Note that when getting
a value of such a parameter, the user will not get <code class="docutils literal notranslate"><span class="pre">'ON'</span></code> or <code class="docutils literal notranslate"><span class="pre">'off'</span></code> or <code class="docutils literal notranslate"><span class="pre">'oFF'</span></code> - instead, <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code> will be returned.</p>
</div>
</div>
<div class="section" id="Dynamically-adding-and-removing-parameters">
<h2>Dynamically adding and removing parameters<a class="headerlink" href="#Dynamically-adding-and-removing-parameters" title="Permalink to this headline">¶</a></h2>
<p>Sometimes when conditions change (for example, the mode of operation of the instrument is changed from current to voltage measurement) you want different parameters to be available.</p>
<p>To delete existing parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">name_to_delete</span><span class="p">]</span>
</pre></div>
</div>
<p>And to add more, do the same thing as you did initially:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">new_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Organization">
<h2>Organization<a class="headerlink" href="#Organization" title="Permalink to this headline">¶</a></h2>
<p>Your drivers do not need to be part of QCoDeS in order to use them with QCoDeS, but we strongly encourage you to contribute them to the project. That way we prevent duplication of effort, and you will likely get help making the driver better, with more features and better code.</p>
<p>Make one driver per module, inside a directory named for the company (or institution), within the <code class="docutils literal notranslate"><span class="pre">instrument_drivers</span></code> directory, following the convention:</p>
<p><code class="docutils literal notranslate"><span class="pre">instrument_drivers.&lt;company&gt;.&lt;model&gt;.&lt;company&gt;_&lt;model&gt;</span></code> - example: <code class="docutils literal notranslate"><span class="pre">instrument_drivers.AlazarTech.ATS9870.AlazarTech_ATS9870</span></code></p>
<p>Although the class name can be just the model if it is globally unambiguous. For example: - example: <code class="docutils literal notranslate"><span class="pre">instrument_drivers.stanford_research.SR560.SR560</span></code></p>
<p>And note that due to mergers, some drivers may not be in the folder you expect: - example: <code class="docutils literal notranslate"><span class="pre">instrument_drivers.tektronix.Keithley_2600.Keithley_2600_Channels</span></code></p>
</div>
<div class="section" id="Documentation">
<h2>Documentation<a class="headerlink" href="#Documentation" title="Permalink to this headline">¶</a></h2>
<p>A driver should be documented in the following ways.</p>
<ul class="simple">
<li><p>All methods of the driver class should be documented including the arguments and return type of the function. QCoDeS docstrings uses the <a class="reference external" href="https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_google.html">Google style</a></p></li>
<li><p>Parameters should have a meaningful docstring if the usage of the parameter is not obvious.</p></li>
<li><p>An IPython notebook that documents the usage of the instrument should be added to <code class="docutils literal notranslate"><span class="pre">docs/example/driver_examples/Qcodes</span> <span class="pre">example</span> <span class="pre">with</span> <span class="pre">&lt;company&gt;</span> <span class="pre">&lt;model&gt;.ipynb</span></code> Note that we execute notebooks by default as part of the docs build. That is usually not possible for instrument examples so we want to disable the execution. This can be done as described <a class="reference external" href="https://nbsphinx.readthedocs.io/en/latest/never-execute.html">here</a> editing the notebooks metadata accessible via <code class="docutils literal notranslate"><span class="pre">Edit/Edit</span> <span class="pre">Notebook</span> <span class="pre">Metadata</span></code>
from the notebook interface.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Creating-Simulated-PyVISA-Instruments.html" class="btn btn-neutral float-right" title="Creating Simulated PyVISA Instruments" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="A-ParameterWithSetpoints-Example-with-Dual-Setpoints.html" class="btn btn-neutral float-left" title="A ParameterWithSetpoints Example with Dual Setpoints" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>