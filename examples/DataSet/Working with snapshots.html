

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Working with snapshots &mdash; QCoDeS 0.5.2+111.gc07ae5ee2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Working with Pandas and XArray" href="Working-With-Pandas-and-XArray.html" />
    <link rel="prev" title="The Experiment Container" href="The-Experiment-Container.html" />
    <link href="../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> QCoDeS
          

          
          </a>

          
            
            
              <div class="version">
                0.5.2+111.gc07ae5ee2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">Get Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dataset/index.html">DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">QCoDes API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/generated/qcodes.instrument_drivers.html">qcodes.instrument_drivers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes/index.html">Changelogs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples of using QCoDeS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#basic-examples">Basic examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#parameters">Parameters</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#dataset">DataSet</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Benchmarking.html">Dataset Benchmarking</a></li>
<li class="toctree-l3"><a class="reference internal" href="Dataset Context Manager.html">The Context Manager aka the Measurement Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="Dataset_Performance.html">DataSet Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="Extracting-runs-from-one-DB-file-to-another.html">Extracting runs from one DB file to another</a></li>
<li class="toctree-l3"><a class="reference internal" href="Implementing_doND_using_the_dataset.html">Implementing doND using the dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="Linking to parent datasets.html">Linking to parent datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="Load old data.html">Load old Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="Measuring X as a function of time.html">Measuring X as a function of time</a></li>
<li class="toctree-l3"><a class="reference internal" href="Offline Plotting Tutorial.html">Offline Plotting Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="Offline plotting with categorical data.html">Offline plotting with categorical data</a></li>
<li class="toctree-l3"><a class="reference internal" href="Offline plotting with complex data.html">Offline plotting with complex data</a></li>
<li class="toctree-l3"><a class="reference internal" href="Paramtypes explained.html">Paramtypes explained</a></li>
<li class="toctree-l3"><a class="reference internal" href="Pedestrian example of subscribing to a DataSet.html">Pedestrian example of subscribing to a DataSet</a></li>
<li class="toctree-l3"><a class="reference internal" href="The-Experiment-Container.html">The Experiment Container</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Working with snapshots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Useful-imports">Useful imports</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Snapshot-example-for-Parameter-object">Snapshot example for Parameter object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Snapshot-of-an-Instrument">Snapshot of an Instrument</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Station-and-its-snapshot">Station and its snapshot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Working-With-Pandas-and-XArray.html">Working with Pandas and XArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="subscriber json exporter.html">Subscriber with JSON export</a></li>
<li class="toctree-l3"><a class="reference internal" href="Real_instruments/Example Measurements with Real Instruments.html">Example Measurements with Real Instruments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#plotting">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#drivers">Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#writing-drivers">Writing Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#logging">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#legacy-examples">Legacy examples</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QCoDeS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Examples of using QCoDeS</a> &raquo;</li>
        
      <li>Working with snapshots</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/examples/DataSet/Working with snapshots.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Working-with-snapshots">
<h1>Working with snapshots<a class="headerlink" href="#Working-with-snapshots" title="Permalink to this headline">¶</a></h1>
<p>Here, the following topics are going to be covered:</p>
<ul class="simple">
<li><p>What is a snapshot</p></li>
<li><p>How to create it</p></li>
<li><p>How it is saved next to the measurement data</p></li>
<li><p>How to extract snapshot from the dataset</p></li>
</ul>
<div class="section" id="Useful-imports">
<h2>Useful imports<a class="headerlink" href="#Useful-imports" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="k">import</span> <span class="n">pprint</span>  <span class="c1"># for pretty-printing python variables like &#39;dict&#39;</span>
<span class="kn">import</span> <span class="nn">json</span>  <span class="c1"># for converting JSON data into python &#39;dict&#39;</span>

<span class="kn">import</span> <span class="nn">qcodes</span>
<span class="kn">from</span> <span class="nn">qcodes</span> <span class="k">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">Station</span><span class="p">,</span> \
                   <span class="n">initialise_database</span><span class="p">,</span> \
                   <span class="n">load_or_create_experiment</span><span class="p">,</span> <span class="n">Measurement</span>
<span class="kn">from</span> <span class="nn">qcodes.tests.instrument_mocks</span> <span class="k">import</span> <span class="n">DummyInstrument</span>
</pre></div>
</div>
</div>
<div class="section" id="What-is-a-snapshot">
<h3>What is a snapshot<a class="headerlink" href="#What-is-a-snapshot" title="Permalink to this headline">¶</a></h3>
<p>Often times experiments comprise a complex network of interconnected instruments. Their numerous settings define the overall behavior of the experimental setup. Obviously, the experimental setup has a direct impact on the measured data which is of prime interest for researchers. In order to capture this link, the measured data should have metadata associated with it. An important part of that metadata is a captured state of the experimental setup. In QCoDeS terms, this is called snapshot.</p>
</div>
<div class="section" id="How-to-create-a-snapshot">
<h3>How to create a snapshot<a class="headerlink" href="#How-to-create-a-snapshot" title="Permalink to this headline">¶</a></h3>
<p>All QCoDeS instruments and parameters (and some other objects too, like <code class="docutils literal notranslate"><span class="pre">InstrumentChannel</span></code>s) support snapshotting, which means that they provide a method to retrieve their state.</p>
<p>Let’s look at snapshots of various objects.</p>
</div>
</div>
<div class="section" id="Snapshot-example-for-Parameter-object">
<h2>Snapshot example for Parameter object<a class="headerlink" href="#Snapshot-example-for-Parameter-object" title="Permalink to this headline">¶</a></h2>
<p>Let’s create a <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>, call its <code class="docutils literal notranslate"><span class="pre">snapshot</span></code> method, and then inspect the output of that method.</p>
<p>The returned snapshot is a python dictionary that reflects all the important properties of that parameter (check the name, label, unit, and even value).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Parameter P&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;kg&#39;</span><span class="p">,</span> <span class="n">set_cmd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_cmd</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">snapshot_of_p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">snapshot</span><span class="p">()</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">snapshot_of_p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
 &#39;full_name&#39;: &#39;p&#39;,
 &#39;inter_delay&#39;: 0,
 &#39;label&#39;: &#39;Parameter P&#39;,
 &#39;name&#39;: &#39;p&#39;,
 &#39;post_delay&#39;: 0,
 &#39;raw_value&#39;: 123,
 &#39;ts&#39;: &#39;2019-08-22 17:04:47&#39;,
 &#39;unit&#39;: &#39;kg&#39;,
 &#39;value&#39;: 123}
</pre></div></div>
</div>
<p>In case you want to use the snapshot object in your code, you can refer to its contents in the same way as you work with python dictionaries, for example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Value of </span><span class="si">{snapshot_of_p[&#39;label&#39;]}</span><span class="s2"> was </span><span class="si">{snapshot_of_p[&#39;value&#39;]}</span><span class="s2"> (when it was snapshotted).&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Value of Parameter P was 123 (when it was snapshotted).
</pre></div></div>
</div>
<p>Note that the implementation of a particular QCoDeS object defines which attributes are snapshotted and how. For example, <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> implements a keyword argument <code class="docutils literal notranslate"><span class="pre">snapshot_value</span></code> which allows to choose if the value of the parameter is snapshotted (the reasons for this are out of scope of this article). (Another interesting keyword argument of <code class="docutils literal notranslate"><span class="pre">Parameter</span></code> that is realated to snapshotting is <code class="docutils literal notranslate"><span class="pre">snapshot_get</span></code> - refer to <code class="docutils literal notranslate"><span class="pre">Parameters</span></code>’s docstring for more information.)</p>
<p>Below is a demonstration of the <code class="docutils literal notranslate"><span class="pre">snapshot_value</span></code> keyword argument, notice that the value of the parameter is not part of the snapshot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">q</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Parameter Q&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">snapshot_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">set_cmd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_cmd</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">456</span><span class="p">)</span>

<span class="n">snapshot_of_q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">snapshot</span><span class="p">()</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">snapshot_of_q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
 &#39;full_name&#39;: &#39;q&#39;,
 &#39;inter_delay&#39;: 0,
 &#39;label&#39;: &#39;Parameter Q&#39;,
 &#39;name&#39;: &#39;q&#39;,
 &#39;post_delay&#39;: 0,
 &#39;ts&#39;: None,
 &#39;unit&#39;: &#39;A&#39;}
</pre></div></div>
</div>
</div>
<div class="section" id="Snapshot-of-an-Instrument">
<h2>Snapshot of an Instrument<a class="headerlink" href="#Snapshot-of-an-Instrument" title="Permalink to this headline">¶</a></h2>
<p>Now let’s have a brief look at snapshots of instruments. For the sake of exercise, we are going to use a “dummy” instrument.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># A dummy instrument with two parameters, &quot;input&quot; and &quot;output&quot;, plus a third one we&#39;ll use later.</span>
<span class="n">instr</span> <span class="o">=</span> <span class="n">DummyInstrument</span><span class="p">(</span><span class="s1">&#39;instr&#39;</span><span class="p">,</span> <span class="n">gates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="s1">&#39;gain&#39;</span><span class="p">])</span>
<span class="n">instr</span><span class="o">.</span><span class="n">gain</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">snapshot_of_instr</span> <span class="o">=</span> <span class="n">instr</span><span class="o">.</span><span class="n">snapshot</span><span class="p">()</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">snapshot_of_instr</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{   &#39;__class__&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
    &#39;functions&#39;: {},
    &#39;name&#39;: &#39;instr&#39;,
    &#39;parameters&#39;: {   &#39;IDN&#39;: {   &#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                 &#39;full_name&#39;: &#39;instr_IDN&#39;,
                                 &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                 &#39;instrument_name&#39;: &#39;instr&#39;,
                                 &#39;inter_delay&#39;: 0,
                                 &#39;label&#39;: &#39;IDN&#39;,
                                 &#39;name&#39;: &#39;IDN&#39;,
                                 &#39;post_delay&#39;: 0,
                                 &#39;raw_value&#39;: None,
                                 &#39;ts&#39;: None,
                                 &#39;unit&#39;: &#39;&#39;,
                                 &#39;vals&#39;: &#39;&lt;Anything&gt;&#39;,
                                 &#39;value&#39;: None},
                      &#39;gain&#39;: {   &#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                  &#39;full_name&#39;: &#39;instr_gain&#39;,
                                  &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                  &#39;instrument_name&#39;: &#39;instr&#39;,
                                  &#39;inter_delay&#39;: 0,
                                  &#39;label&#39;: &#39;Gate gain&#39;,
                                  &#39;name&#39;: &#39;gain&#39;,
                                  &#39;post_delay&#39;: 0,
                                  &#39;raw_value&#39;: 11,
                                  &#39;ts&#39;: &#39;2019-08-22 17:04:47&#39;,
                                  &#39;unit&#39;: &#39;V&#39;,
                                  &#39;vals&#39;: &#39;&lt;Numbers -800&lt;=v&lt;=400&gt;&#39;,
                                  &#39;value&#39;: 11},
                      &#39;input&#39;: {   &#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                   &#39;full_name&#39;: &#39;instr_input&#39;,
                                   &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                   &#39;instrument_name&#39;: &#39;instr&#39;,
                                   &#39;inter_delay&#39;: 0,
                                   &#39;label&#39;: &#39;Gate input&#39;,
                                   &#39;name&#39;: &#39;input&#39;,
                                   &#39;post_delay&#39;: 0,
                                   &#39;raw_value&#39;: 0,
                                   &#39;ts&#39;: &#39;2019-08-22 17:04:47&#39;,
                                   &#39;unit&#39;: &#39;V&#39;,
                                   &#39;vals&#39;: &#39;&lt;Numbers -800&lt;=v&lt;=400&gt;&#39;,
                                   &#39;value&#39;: 0},
                      &#39;output&#39;: {   &#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                    &#39;full_name&#39;: &#39;instr_output&#39;,
                                    &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                    &#39;instrument_name&#39;: &#39;instr&#39;,
                                    &#39;inter_delay&#39;: 0,
                                    &#39;label&#39;: &#39;Gate output&#39;,
                                    &#39;name&#39;: &#39;output&#39;,
                                    &#39;post_delay&#39;: 0,
                                    &#39;raw_value&#39;: 0,
                                    &#39;ts&#39;: &#39;2019-08-22 17:04:47&#39;,
                                    &#39;unit&#39;: &#39;V&#39;,
                                    &#39;vals&#39;: &#39;&lt;Numbers -800&lt;=v&lt;=400&gt;&#39;,
                                    &#39;value&#39;: 0}},
    &#39;submodules&#39;: {}}
</pre></div></div>
</div>
</div>
<div class="section" id="Station-and-its-snapshot">
<h2>Station and its snapshot<a class="headerlink" href="#Station-and-its-snapshot" title="Permalink to this headline">¶</a></h2>
<p>Experimental setups are large, and instruments tend to be quite complex in that they comprise many parameters and other stateful parts. It would be very time-consuming for the user to manually go through every instrument and parameter, and collect the snapshot data.</p>
<p>Here is where the concept of station comes into play. Instruments, parameters, and other submodules can be added to a <a class="reference internal" href="../Station.html"><span class="doc">Station object</span></a> (<a class="reference external" href="https://nbviewer.jupyter.org/github/QCoDeS/Qcodes/tree/master/docs/examples/Station.ipynb">nbviewer.jupyter.org link</a>). In turn, the station has its <code class="docutils literal notranslate"><span class="pre">snapshot</span></code> method that allows to create a collective, single snapshot of all the instruments, parameters, and submodules.</p>
<p>Note that in this article the focus is on the snapshot feature of the QCoDeS <code class="docutils literal notranslate"><span class="pre">Station</span></code>, while it has some other features (also some legacy once).</p>
<p>Let’s create a station, and add a parameter, instrument, and submodule to it. Then we will print the snapshot. Notice that the station is aware of insturments and stand-alone parameters, and classifies them into dedicated lists within the snapshot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">station</span> <span class="o">=</span> <span class="n">Station</span><span class="p">()</span>

<span class="n">station</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">station</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">instr</span><span class="p">)</span>
<span class="c1"># Note that it is also possible to add components</span>
<span class="c1"># to a station via arguments of its constructor, like this:</span>
<span class="c1">#     station = Station(p, instr)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;instr&#39;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">snapshot_of_station</span> <span class="o">=</span> <span class="n">station</span><span class="o">.</span><span class="n">snapshot</span><span class="p">()</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">snapshot_of_station</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;components&#39;: {},
 &#39;default_measurement&#39;: [],
 &#39;instruments&#39;: {&#39;instr&#39;: {&#39;__class__&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                           &#39;functions&#39;: {},
                           &#39;name&#39;: &#39;instr&#39;,
                           &#39;parameters&#39;: {&#39;IDN&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                                  &#39;full_name&#39;: &#39;instr_IDN&#39;,
                                                  &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                                  &#39;instrument_name&#39;: &#39;instr&#39;,
                                                  &#39;inter_delay&#39;: 0,
                                                  &#39;label&#39;: &#39;IDN&#39;,
                                                  &#39;name&#39;: &#39;IDN&#39;,
                                                  &#39;post_delay&#39;: 0,
                                                  &#39;raw_value&#39;: {&#39;firmware&#39;: None,
                                                                &#39;model&#39;: &#39;instr&#39;,
                                                                &#39;serial&#39;: None,
                                                                &#39;vendor&#39;: None},
                                                  &#39;ts&#39;: &#39;2019-08-22 17:04:47&#39;,
                                                  &#39;unit&#39;: &#39;&#39;,
                                                  &#39;vals&#39;: &#39;&lt;Anything&gt;&#39;,
                                                  &#39;value&#39;: {&#39;firmware&#39;: None,
                                                            &#39;model&#39;: &#39;instr&#39;,
                                                            &#39;serial&#39;: None,
                                                            &#39;vendor&#39;: None}},
                                          &#39;gain&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                                   &#39;full_name&#39;: &#39;instr_gain&#39;,
                                                   &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                                   &#39;instrument_name&#39;: &#39;instr&#39;,
                                                   &#39;inter_delay&#39;: 0,
                                                   &#39;label&#39;: &#39;Gate gain&#39;,
                                                   &#39;name&#39;: &#39;gain&#39;,
                                                   &#39;post_delay&#39;: 0,
                                                   &#39;raw_value&#39;: 11,
                                                   &#39;ts&#39;: &#39;2019-08-22 17:04:47&#39;,
                                                   &#39;unit&#39;: &#39;V&#39;,
                                                   &#39;vals&#39;: &#39;&lt;Numbers &#39;
                                                           &#39;-800&lt;=v&lt;=400&gt;&#39;,
                                                   &#39;value&#39;: 11},
                                          &#39;input&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                                    &#39;full_name&#39;: &#39;instr_input&#39;,
                                                    &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                                    &#39;instrument_name&#39;: &#39;instr&#39;,
                                                    &#39;inter_delay&#39;: 0,
                                                    &#39;label&#39;: &#39;Gate input&#39;,
                                                    &#39;name&#39;: &#39;input&#39;,
                                                    &#39;post_delay&#39;: 0,
                                                    &#39;raw_value&#39;: 0,
                                                    &#39;ts&#39;: &#39;2019-08-22 17:04:47&#39;,
                                                    &#39;unit&#39;: &#39;V&#39;,
                                                    &#39;vals&#39;: &#39;&lt;Numbers &#39;
                                                            &#39;-800&lt;=v&lt;=400&gt;&#39;,
                                                    &#39;value&#39;: 0},
                                          &#39;output&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                                     &#39;full_name&#39;: &#39;instr_output&#39;,
                                                     &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                                     &#39;instrument_name&#39;: &#39;instr&#39;,
                                                     &#39;inter_delay&#39;: 0,
                                                     &#39;label&#39;: &#39;Gate output&#39;,
                                                     &#39;name&#39;: &#39;output&#39;,
                                                     &#39;post_delay&#39;: 0,
                                                     &#39;raw_value&#39;: 0,
                                                     &#39;ts&#39;: &#39;2019-08-22 &#39;
                                                           &#39;17:04:47&#39;,
                                                     &#39;unit&#39;: &#39;V&#39;,
                                                     &#39;vals&#39;: &#39;&lt;Numbers &#39;
                                                             &#39;-800&lt;=v&lt;=400&gt;&#39;,
                                                     &#39;value&#39;: 0}},
                           &#39;submodules&#39;: {}}},
 &#39;parameters&#39;: {&#39;p&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                      &#39;full_name&#39;: &#39;p&#39;,
                      &#39;inter_delay&#39;: 0,
                      &#39;label&#39;: &#39;Parameter P&#39;,
                      &#39;name&#39;: &#39;p&#39;,
                      &#39;post_delay&#39;: 0,
                      &#39;raw_value&#39;: 456,
                      &#39;ts&#39;: &#39;2019-08-22 17:04:47&#39;,
                      &#39;unit&#39;: &#39;kg&#39;,
                      &#39;value&#39;: 456}}}
</pre></div></div>
</div>
<div class="section" id="Saving-snapshot-next-to-the-measurement-data">
<h3>Saving snapshot next to the measurement data<a class="headerlink" href="#Saving-snapshot-next-to-the-measurement-data" title="Permalink to this headline">¶</a></h3>
<p>With the power of the station object, it is now possible to conveniently associate the snapshot information with the measured data.</p>
<p>In order to do so, a station needs to be created, and then that station needs to be provided to the <code class="docutils literal notranslate"><span class="pre">Measurement</span></code> object. If no station is explicitly provided, the <code class="docutils literal notranslate"><span class="pre">Measurement</span></code> object will use the default station, <code class="docutils literal notranslate"><span class="pre">Station.default</span></code> (refer to <code class="docutils literal notranslate"><span class="pre">Measurement</span></code> and <code class="docutils literal notranslate"><span class="pre">Station</span></code> objects docstrings for more information). At the moment the new measurement run is started, a snapshot of the whole station will be taken, and added next to the measured data.</p>
<p>Note that the snapshot gets stored in a JSON format (an automatic convertion from python dictionary to JSON takes place). This is done in order to ensure that the snapshot can be read in environments other than python. JSON is an extemely popular data format, and all platforms/environments/languages/frameworks have means to read JSON-formatted data.</p>
<p>Here is how it looks in the code. We will create a new experiment. Then we are going to reuse the station object created above, and create a new measurement object. Then we will perform a dummy measurement. After that we are going to extract the snapshot from the resulting dataset, and print it.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Let&#39;s initialize a database to ensure that it exists</span>
<span class="n">initialise_database</span><span class="p">()</span>

<span class="c1"># Let&#39;s create a new experiment</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">load_or_create_experiment</span><span class="p">(</span><span class="s1">&#39;snapshot_experiment&#39;</span><span class="p">,</span> <span class="s1">&#39;no_sample_yet&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">measurement</span> <span class="o">=</span> <span class="n">Measurement</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">station</span><span class="p">)</span>

<span class="n">measurement</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
<span class="n">measurement</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">setpoints</span><span class="o">=</span><span class="p">[</span><span class="n">instr</span><span class="o">.</span><span class="n">input</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;qcodes.dataset.measurements.Measurement at 0x7f3bc2dbfc50&gt;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">measurement</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="k">as</span> <span class="n">data_saver</span><span class="p">:</span>
    <span class="n">input_value</span> <span class="o">=</span> <span class="mi">111</span>
    <span class="n">instr</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">input_value</span><span class="p">)</span>

    <span class="n">instr</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>  <span class="c1"># assuming that the instrument measured this value on the output</span>

    <span class="n">data_saver</span><span class="o">.</span><span class="n">add_result</span><span class="p">((</span><span class="n">instr</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">input_value</span><span class="p">),</span>
                          <span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">instr</span><span class="o">.</span><span class="n">output</span><span class="p">()))</span>

<span class="c1"># For convenience, let&#39;s work with the dataset object directly</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">data_saver</span><span class="o">.</span><span class="n">dataset</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Starting experimental run with id: 47
</pre></div></div>
</div>
</div>
<div class="section" id="Extracting-snapshot-from-dataset">
<h3>Extracting snapshot from dataset<a class="headerlink" href="#Extracting-snapshot-from-dataset" title="Permalink to this headline">¶</a></h3>
<p>Now we have a dataset that contains data from the measurement run. It also contains the snapshot.</p>
<p>In order to access the snapshot, use the <code class="docutils literal notranslate"><span class="pre">DataSet</span></code>’s properties called <code class="docutils literal notranslate"><span class="pre">snapshot</span></code> and <code class="docutils literal notranslate"><span class="pre">snapshot_raw</span></code>. As their docstrings declare, the former returns the snapshot of the run as a python dictionary, while the latter returns it as JSON string (in other words, in exactly the same format as it is stored in the experiments database).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">snapshot_of_run</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">snapshot</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">snapshot_of_run_in_json_format</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">snapshot_raw</span>
</pre></div>
</div>
</div>
<p>To prove that these snapshots are the same, use <code class="docutils literal notranslate"><span class="pre">json.loads</span></code> or <code class="docutils literal notranslate"><span class="pre">json.dumps</span></code> to assert the values of the variables:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">assert</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">snapshot_of_run_in_json_format</span><span class="p">)</span> <span class="o">==</span> <span class="n">snapshot_of_run</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">assert</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">snapshot_of_run</span><span class="p">)</span> <span class="o">==</span> <span class="n">snapshot_of_run_in_json_format</span>
</pre></div>
</div>
</div>
<p>Finally, let’s pretty-print the snapshot. Notice that the values of the <code class="docutils literal notranslate"><span class="pre">input</span></code> and <code class="docutils literal notranslate"><span class="pre">output</span></code> parameters of the <code class="docutils literal notranslate"><span class="pre">instr</span></code> instrument have <code class="docutils literal notranslate"><span class="pre">0</span></code>s as values, and not <code class="docutils literal notranslate"><span class="pre">111</span></code> and <code class="docutils literal notranslate"><span class="pre">222</span></code> that were set during the measurement run.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pprint</span><span class="p">(</span><span class="n">snapshot_of_run</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;station&#39;: {&#39;components&#39;: {},
             &#39;default_measurement&#39;: [],
             &#39;instruments&#39;: {&#39;instr&#39;: {&#39;__class__&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                       &#39;functions&#39;: {},
                                       &#39;name&#39;: &#39;instr&#39;,
                                       &#39;parameters&#39;: {&#39;IDN&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                                              &#39;full_name&#39;: &#39;instr_IDN&#39;,
                                                              &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                                              &#39;instrument_name&#39;: &#39;instr&#39;,
                                                              &#39;inter_delay&#39;: 0,
                                                              &#39;label&#39;: &#39;IDN&#39;,
                                                              &#39;name&#39;: &#39;IDN&#39;,
                                                              &#39;post_delay&#39;: 0,
                                                              &#39;raw_value&#39;: {&#39;firmware&#39;: None,
                                                                            &#39;model&#39;: &#39;instr&#39;,
                                                                            &#39;serial&#39;: None,
                                                                            &#39;vendor&#39;: None},
                                                              &#39;ts&#39;: &#39;2019-08-22 &#39;
                                                                    &#39;17:04:47&#39;,
                                                              &#39;unit&#39;: &#39;&#39;,
                                                              &#39;vals&#39;: &#39;&lt;Anything&gt;&#39;,
                                                              &#39;value&#39;: {&#39;firmware&#39;: None,
                                                                        &#39;model&#39;: &#39;instr&#39;,
                                                                        &#39;serial&#39;: None,
                                                                        &#39;vendor&#39;: None}},
                                                      &#39;gain&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                                               &#39;full_name&#39;: &#39;instr_gain&#39;,
                                                               &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                                               &#39;instrument_name&#39;: &#39;instr&#39;,
                                                               &#39;inter_delay&#39;: 0,
                                                               &#39;label&#39;: &#39;Gate &#39;
                                                                        &#39;gain&#39;,
                                                               &#39;name&#39;: &#39;gain&#39;,
                                                               &#39;post_delay&#39;: 0,
                                                               &#39;raw_value&#39;: 11,
                                                               &#39;ts&#39;: &#39;2019-08-22 &#39;
                                                                     &#39;17:04:47&#39;,
                                                               &#39;unit&#39;: &#39;V&#39;,
                                                               &#39;vals&#39;: &#39;&lt;Numbers &#39;
                                                                       &#39;-800&lt;=v&lt;=400&gt;&#39;,
                                                               &#39;value&#39;: 11},
                                                      &#39;input&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                                                &#39;full_name&#39;: &#39;instr_input&#39;,
                                                                &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                                                &#39;instrument_name&#39;: &#39;instr&#39;,
                                                                &#39;inter_delay&#39;: 0,
                                                                &#39;label&#39;: &#39;Gate &#39;
                                                                         &#39;input&#39;,
                                                                &#39;name&#39;: &#39;input&#39;,
                                                                &#39;post_delay&#39;: 0,
                                                                &#39;raw_value&#39;: 0,
                                                                &#39;ts&#39;: &#39;2019-08-22 &#39;
                                                                      &#39;17:04:47&#39;,
                                                                &#39;unit&#39;: &#39;V&#39;,
                                                                &#39;vals&#39;: &#39;&lt;Numbers &#39;
                                                                        &#39;-800&lt;=v&lt;=400&gt;&#39;,
                                                                &#39;value&#39;: 0},
                                                      &#39;output&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                                                 &#39;full_name&#39;: &#39;instr_output&#39;,
                                                                 &#39;instrument&#39;: &#39;qcodes.tests.instrument_mocks.DummyInstrument&#39;,
                                                                 &#39;instrument_name&#39;: &#39;instr&#39;,
                                                                 &#39;inter_delay&#39;: 0,
                                                                 &#39;label&#39;: &#39;Gate &#39;
                                                                          &#39;output&#39;,
                                                                 &#39;name&#39;: &#39;output&#39;,
                                                                 &#39;post_delay&#39;: 0,
                                                                 &#39;raw_value&#39;: 0,
                                                                 &#39;ts&#39;: &#39;2019-08-22 &#39;
                                                                       &#39;17:04:47&#39;,
                                                                 &#39;unit&#39;: &#39;V&#39;,
                                                                 &#39;vals&#39;: &#39;&lt;Numbers &#39;
                                                                         &#39;-800&lt;=v&lt;=400&gt;&#39;,
                                                                 &#39;value&#39;: 0}},
                                       &#39;submodules&#39;: {}}},
             &#39;parameters&#39;: {&#39;p&#39;: {&#39;__class__&#39;: &#39;qcodes.instrument.parameter.Parameter&#39;,
                                  &#39;full_name&#39;: &#39;p&#39;,
                                  &#39;inter_delay&#39;: 0,
                                  &#39;label&#39;: &#39;Parameter P&#39;,
                                  &#39;name&#39;: &#39;p&#39;,
                                  &#39;post_delay&#39;: 0,
                                  &#39;raw_value&#39;: 456,
                                  &#39;ts&#39;: &#39;2019-08-22 17:04:47&#39;,
                                  &#39;unit&#39;: &#39;kg&#39;,
                                  &#39;value&#39;: 456}}}}
</pre></div></div>
</div>
<p>Note that the snapshot that we have just loaded from the dataset is almost the same as the snapshot that we directly obtained from the station above. The only difference is that the snapshot loaded from the dataset has a top-level <code class="docutils literal notranslate"><span class="pre">station</span></code> field. If you do not trust me, have a look at the following <code class="docutils literal notranslate"><span class="pre">assert</span></code> statement for the proof.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">assert</span> <span class="p">{</span><span class="s1">&#39;station&#39;</span><span class="p">:</span> <span class="n">snapshot_of_station</span><span class="p">}</span> <span class="o">==</span> <span class="n">snapshot_of_run</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Comparing-how-two-DataSets-were-taken">
<h3>Comparing how two DataSets were taken<a class="headerlink" href="#Comparing-how-two-DataSets-were-taken" title="Permalink to this headline">¶</a></h3>
<p>Suppose something went wrong in an experiment, and you’d like to compare what changed since a known-good run. QCoDeS lets you do this by taking a <em>diff</em> between the snapshots for two <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> instances.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">measurement</span> <span class="o">=</span> <span class="n">Measurement</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">station</span><span class="p">)</span>

<span class="n">measurement</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">input</span><span class="p">)</span>
<span class="n">measurement</span><span class="o">.</span><span class="n">register_parameter</span><span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">setpoints</span><span class="o">=</span><span class="p">[</span><span class="n">instr</span><span class="o">.</span><span class="n">input</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;qcodes.dataset.measurements.Measurement at 0x7f3bc2d73208&gt;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">instr</span><span class="o">.</span><span class="n">gain</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span> <span class="c1"># Oops!</span>
<span class="k">with</span> <span class="n">measurement</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="k">as</span> <span class="n">data_saver</span><span class="p">:</span>
    <span class="n">input_value</span> <span class="o">=</span> <span class="mi">111</span>
    <span class="n">instr</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">input_value</span><span class="p">)</span>

    <span class="n">instr</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>  <span class="c1"># assuming that the instrument measured this value on the output</span>

    <span class="n">data_saver</span><span class="o">.</span><span class="n">add_result</span><span class="p">((</span><span class="n">instr</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">input_value</span><span class="p">),</span>
                          <span class="p">(</span><span class="n">instr</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">instr</span><span class="o">.</span><span class="n">output</span><span class="p">()))</span>

<span class="c1"># For convenience, let&#39;s work with the dataset object directly</span>
<span class="n">bad_dataset</span> <span class="o">=</span> <span class="n">data_saver</span><span class="o">.</span><span class="n">dataset</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Starting experimental run with id: 48
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">diff_param_values</span></code> function tells us about the parameters that changed betw</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">qcodes.utils.metadata</span> <span class="k">import</span> <span class="n">diff_param_values</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diff_param_values</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">bad_dataset</span><span class="o">.</span><span class="n">snapshot</span><span class="p">)</span><span class="o">.</span><span class="n">changed</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>{(&#39;instr&#39;, &#39;input&#39;): (0, 111),
 (&#39;instr&#39;, &#39;output&#39;): (0, 222),
 (&#39;instr&#39;, &#39;gain&#39;): (11, 400)}
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Working-With-Pandas-and-XArray.html" class="btn btn-neutral float-right" title="Working with Pandas and XArray" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="The-Experiment-Container.html" class="btn btn-neutral float-left" title="The Experiment Container" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>